/* empty css              */import{C as _n,V as S,M as se,T as te,Q as be,S as xt,a as D,R as mn,P as gn,b as ve,L as jt,F as we,c as V,d as U,B as Gt,e as ue,f as X,g as Ke,h as yn,i as ze,j as Kt,k as de,l as B,m as Tn,n as bn,D as vn,o as xe,I as wn,p as xn,O as zt,q as Vt,r as An,s as En,t as Xt,N as Sn,u as Mn,v as Ln,w as Ae,x as Yt,y as fe,z as Rn,A as Dn,E as Pn,G as Pe,H as In,J as ht,K as qt,U as q,W as kn,X as On,Y as pe,Z as Cn,_ as Nn,$ as Fn,a0 as Hn,a1 as Ie,a2 as Wt,a3 as Un,a4 as Bn,a5 as jn,a6 as Gn,a7 as Kn,a8 as Zt,a9 as zn,aa as At,ab as Et,ac as St,ad as Mt,ae as Vn,af as Xn,ag as Yn,ah as qn,ai as Wn,aj as Zn,ak as Jn,al as Qn,am as pt,an as N,ao as Se,ap as Lt,aq as $n,ar as es}from"./vendor-LxNUTRMv.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();const Rt={type:"change"},_t={type:"start"},Jt={type:"end"},_e=new mn,Dt=new gn,ts=Math.cos(70*ve.DEG2RAD),ns=new S(-3,-1,-4),ss=new S(2,5,8),E=new S,R=2*Math.PI,x={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},ke=1e-6;class os extends _n{constructor(n,e=null){super(n,e),this.state=x.NONE,this.enabled=!0,this.target=new S,this.cursor=new S,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:se.ROTATE,MIDDLE:se.DOLLY,RIGHT:se.PAN},this.touches={ONE:te.ROTATE,TWO:te.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new S,this._lastQuaternion=new be,this._lastTargetPosition=new S,this._quat=new be().setFromUnitVectors(n.up,new S(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new xt,this._sphericalDelta=new xt,this._scale=1,this._panOffset=new S,this._rotateStart=new D,this._rotateEnd=new D,this._rotateDelta=new D,this._panStart=new D,this._panEnd=new D,this._panDelta=new D,this._dollyStart=new D,this._dollyEnd=new D,this._dollyDelta=new D,this._dollyDirection=new S,this._mouse=new D,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=rs.bind(this),this._onPointerDown=is.bind(this),this._onPointerUp=as.bind(this),this._onContextMenu=ps.bind(this),this._onMouseWheel=us.bind(this),this._onKeyDown=ds.bind(this),this._onTouchStart=fs.bind(this),this._onTouchMove=hs.bind(this),this._onMouseDown=ls.bind(this),this._onMouseMove=cs.bind(this),this._interceptControlDown=_s.bind(this),this._interceptControlUp=ms.bind(this),this.domElement!==null&&this.connect(),this.update()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(n){n.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=n}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(Rt),this.update(),this.state=x.NONE}update(n=null){const e=this.object.position;E.copy(e).sub(this.target),E.applyQuaternion(this._quat),this._spherical.setFromVector3(E),this.autoRotate&&this.state===x.NONE&&this._rotateLeft(this._getAutoRotationAngle(n)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let i=this.minAzimuthAngle,s=this.maxAzimuthAngle;isFinite(i)&&isFinite(s)&&(i<-Math.PI?i+=R:i>Math.PI&&(i-=R),s<-Math.PI?s+=R:s>Math.PI&&(s-=R),i<=s?this._spherical.theta=Math.max(i,Math.min(s,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(i+s)/2?Math.max(i,this._spherical.theta):Math.min(s,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.clamp(ns,ss),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let r=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const a=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),r=a!=this._spherical.radius}if(E.setFromSpherical(this._spherical),E.applyQuaternion(this._quatInverse),e.copy(this.target).add(E),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let a=null;if(this.object.isPerspectiveCamera){const u=E.length();a=this._clampDistance(u*this._scale);const c=u-a;this.object.position.addScaledVector(this._dollyDirection,c),this.object.updateMatrixWorld(),r=!!c}else if(this.object.isOrthographicCamera){const u=new S(this._mouse.x,this._mouse.y,0);u.unproject(this.object);const c=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),r=c!==this.object.zoom;const d=new S(this._mouse.x,this._mouse.y,0);d.unproject(this.object),this.object.position.sub(d).add(u),this.object.updateMatrixWorld(),a=E.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;a!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(a).add(this.object.position):(_e.origin.copy(this.object.position),_e.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(_e.direction))<ts?this.object.lookAt(this.target):(Dt.setFromNormalAndCoplanarPoint(this.object.up,this.target),_e.intersectPlane(Dt,this.target))))}else if(this.object.isOrthographicCamera){const a=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),a!==this.object.zoom&&(this.object.updateProjectionMatrix(),r=!0)}return this._scale=1,this._performCursorZoom=!1,r||this._lastPosition.distanceToSquared(this.object.position)>ke||8*(1-this._lastQuaternion.dot(this.object.quaternion))>ke||this._lastTargetPosition.distanceToSquared(this.target)>ke?(this.dispatchEvent(Rt),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(n){return n!==null?R/60*this.autoRotateSpeed*n:R/60/60*this.autoRotateSpeed}_getZoomScale(n){const e=Math.abs(n*.01);return Math.pow(.95,this.zoomSpeed*e)}_rotateLeft(n){this._sphericalDelta.theta-=n}_rotateUp(n){this._sphericalDelta.phi-=n}_panLeft(n,e){E.setFromMatrixColumn(e,0),E.multiplyScalar(-n),this._panOffset.add(E)}_panUp(n,e){this.screenSpacePanning===!0?E.setFromMatrixColumn(e,1):(E.setFromMatrixColumn(e,0),E.crossVectors(this.object.up,E)),E.multiplyScalar(n),this._panOffset.add(E)}_pan(n,e){const i=this.domElement;if(this.object.isPerspectiveCamera){const s=this.object.position;E.copy(s).sub(this.target);let r=E.length();r*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*n*r/i.clientHeight,this.object.matrix),this._panUp(2*e*r/i.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(n*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrix),this._panUp(e*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(n){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=n:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(n){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=n:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(n,e){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const i=this.domElement.getBoundingClientRect(),s=n-i.left,r=e-i.top,a=i.width,u=i.height;this._mouse.x=s/a*2-1,this._mouse.y=-(r/u)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(n){return Math.max(this.minDistance,Math.min(this.maxDistance,n))}_handleMouseDownRotate(n){this._rotateStart.set(n.clientX,n.clientY)}_handleMouseDownDolly(n){this._updateZoomParameters(n.clientX,n.clientX),this._dollyStart.set(n.clientX,n.clientY)}_handleMouseDownPan(n){this._panStart.set(n.clientX,n.clientY)}_handleMouseMoveRotate(n){this._rotateEnd.set(n.clientX,n.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const e=this.domElement;this._rotateLeft(R*this._rotateDelta.x/e.clientHeight),this._rotateUp(R*this._rotateDelta.y/e.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(n){this._dollyEnd.set(n.clientX,n.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(n){this._panEnd.set(n.clientX,n.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(n){this._updateZoomParameters(n.clientX,n.clientY),n.deltaY<0?this._dollyIn(this._getZoomScale(n.deltaY)):n.deltaY>0&&this._dollyOut(this._getZoomScale(n.deltaY)),this.update()}_handleKeyDown(n){let e=!1;switch(n.code){case this.keys.UP:n.ctrlKey||n.metaKey||n.shiftKey?this.enableRotate&&this._rotateUp(R*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),e=!0;break;case this.keys.BOTTOM:n.ctrlKey||n.metaKey||n.shiftKey?this.enableRotate&&this._rotateUp(-R*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),e=!0;break;case this.keys.LEFT:n.ctrlKey||n.metaKey||n.shiftKey?this.enableRotate&&this._rotateLeft(R*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),e=!0;break;case this.keys.RIGHT:n.ctrlKey||n.metaKey||n.shiftKey?this.enableRotate&&this._rotateLeft(-R*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),e=!0;break}e&&(n.preventDefault(),this.update())}_handleTouchStartRotate(n){if(this._pointers.length===1)this._rotateStart.set(n.pageX,n.pageY);else{const e=this._getSecondPointerPosition(n),i=.5*(n.pageX+e.x),s=.5*(n.pageY+e.y);this._rotateStart.set(i,s)}}_handleTouchStartPan(n){if(this._pointers.length===1)this._panStart.set(n.pageX,n.pageY);else{const e=this._getSecondPointerPosition(n),i=.5*(n.pageX+e.x),s=.5*(n.pageY+e.y);this._panStart.set(i,s)}}_handleTouchStartDolly(n){const e=this._getSecondPointerPosition(n),i=n.pageX-e.x,s=n.pageY-e.y,r=Math.sqrt(i*i+s*s);this._dollyStart.set(0,r)}_handleTouchStartDollyPan(n){this.enableZoom&&this._handleTouchStartDolly(n),this.enablePan&&this._handleTouchStartPan(n)}_handleTouchStartDollyRotate(n){this.enableZoom&&this._handleTouchStartDolly(n),this.enableRotate&&this._handleTouchStartRotate(n)}_handleTouchMoveRotate(n){if(this._pointers.length==1)this._rotateEnd.set(n.pageX,n.pageY);else{const i=this._getSecondPointerPosition(n),s=.5*(n.pageX+i.x),r=.5*(n.pageY+i.y);this._rotateEnd.set(s,r)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const e=this.domElement;this._rotateLeft(R*this._rotateDelta.x/e.clientHeight),this._rotateUp(R*this._rotateDelta.y/e.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(n){if(this._pointers.length===1)this._panEnd.set(n.pageX,n.pageY);else{const e=this._getSecondPointerPosition(n),i=.5*(n.pageX+e.x),s=.5*(n.pageY+e.y);this._panEnd.set(i,s)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(n){const e=this._getSecondPointerPosition(n),i=n.pageX-e.x,s=n.pageY-e.y,r=Math.sqrt(i*i+s*s);this._dollyEnd.set(0,r),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const a=(n.pageX+e.x)*.5,u=(n.pageY+e.y)*.5;this._updateZoomParameters(a,u)}_handleTouchMoveDollyPan(n){this.enableZoom&&this._handleTouchMoveDolly(n),this.enablePan&&this._handleTouchMovePan(n)}_handleTouchMoveDollyRotate(n){this.enableZoom&&this._handleTouchMoveDolly(n),this.enableRotate&&this._handleTouchMoveRotate(n)}_addPointer(n){this._pointers.push(n.pointerId)}_removePointer(n){delete this._pointerPositions[n.pointerId];for(let e=0;e<this._pointers.length;e++)if(this._pointers[e]==n.pointerId){this._pointers.splice(e,1);return}}_isTrackingPointer(n){for(let e=0;e<this._pointers.length;e++)if(this._pointers[e]==n.pointerId)return!0;return!1}_trackPointer(n){let e=this._pointerPositions[n.pointerId];e===void 0&&(e=new D,this._pointerPositions[n.pointerId]=e),e.set(n.pageX,n.pageY)}_getSecondPointerPosition(n){const e=n.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[e]}_customWheelEvent(n){const e=n.deltaMode,i={clientX:n.clientX,clientY:n.clientY,deltaY:n.deltaY};switch(e){case 1:i.deltaY*=16;break;case 2:i.deltaY*=100;break}return n.ctrlKey&&!this._controlActive&&(i.deltaY*=10),i}}function is(f){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(f.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.domElement.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(f)&&(this._addPointer(f),f.pointerType==="touch"?this._onTouchStart(f):this._onMouseDown(f)))}function rs(f){this.enabled!==!1&&(f.pointerType==="touch"?this._onTouchMove(f):this._onMouseMove(f))}function as(f){switch(this._removePointer(f),this._pointers.length){case 0:this.domElement.releasePointerCapture(f.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(Jt),this.state=x.NONE;break;case 1:const n=this._pointers[0],e=this._pointerPositions[n];this._onTouchStart({pointerId:n,pageX:e.x,pageY:e.y});break}}function ls(f){let n;switch(f.button){case 0:n=this.mouseButtons.LEFT;break;case 1:n=this.mouseButtons.MIDDLE;break;case 2:n=this.mouseButtons.RIGHT;break;default:n=-1}switch(n){case se.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(f),this.state=x.DOLLY;break;case se.ROTATE:if(f.ctrlKey||f.metaKey||f.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(f),this.state=x.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(f),this.state=x.ROTATE}break;case se.PAN:if(f.ctrlKey||f.metaKey||f.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(f),this.state=x.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(f),this.state=x.PAN}break;default:this.state=x.NONE}this.state!==x.NONE&&this.dispatchEvent(_t)}function cs(f){switch(this.state){case x.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(f);break;case x.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(f);break;case x.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(f);break}}function us(f){this.enabled===!1||this.enableZoom===!1||this.state!==x.NONE||(f.preventDefault(),this.dispatchEvent(_t),this._handleMouseWheel(this._customWheelEvent(f)),this.dispatchEvent(Jt))}function ds(f){this.enabled!==!1&&this._handleKeyDown(f)}function fs(f){switch(this._trackPointer(f),this._pointers.length){case 1:switch(this.touches.ONE){case te.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(f),this.state=x.TOUCH_ROTATE;break;case te.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(f),this.state=x.TOUCH_PAN;break;default:this.state=x.NONE}break;case 2:switch(this.touches.TWO){case te.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(f),this.state=x.TOUCH_DOLLY_PAN;break;case te.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(f),this.state=x.TOUCH_DOLLY_ROTATE;break;default:this.state=x.NONE}break;default:this.state=x.NONE}this.state!==x.NONE&&this.dispatchEvent(_t)}function hs(f){switch(this._trackPointer(f),this.state){case x.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(f),this.update();break;case x.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(f),this.update();break;case x.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(f),this.update();break;case x.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(f),this.update();break;default:this.state=x.NONE}}function ps(f){this.enabled!==!1&&f.preventDefault()}function _s(f){f.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function ms(f){f.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const Oe=new WeakMap;class gs extends jt{constructor(n){super(n),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(n){return this.decoderPath=n,this}setDecoderConfig(n){return this.decoderConfig=n,this}setWorkerLimit(n){return this.workerLimit=n,this}load(n,e,i,s){const r=new we(this.manager);r.setPath(this.path),r.setResponseType("arraybuffer"),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials),r.load(n,a=>{this.parse(a,e,s)},i,s)}parse(n,e,i=()=>{}){this.decodeDracoFile(n,e,null,null,V,i).catch(i)}decodeDracoFile(n,e,i,s,r=U,a=()=>{}){const u={attributeIDs:i||this.defaultAttributeIDs,attributeTypes:s||this.defaultAttributeTypes,useUniqueIDs:!!i,vertexColorSpace:r};return this.decodeGeometry(n,u).then(e).catch(a)}decodeGeometry(n,e){const i=JSON.stringify(e);if(Oe.has(n)){const c=Oe.get(n);if(c.key===i)return c.promise;if(n.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let s;const r=this.workerNextTaskID++,a=n.byteLength,u=this._getWorker(r,a).then(c=>(s=c,new Promise((d,_)=>{s._callbacks[r]={resolve:d,reject:_},s.postMessage({type:"decode",id:r,taskConfig:e,buffer:n},[n])}))).then(c=>this._createGeometry(c.geometry));return u.catch(()=>!0).then(()=>{s&&r&&this._releaseTask(s,r)}),Oe.set(n,{key:i,promise:u}),u}_createGeometry(n){const e=new Gt;n.index&&e.setIndex(new ue(n.index.array,1));for(let i=0;i<n.attributes.length;i++){const s=n.attributes[i],r=s.name,a=s.array,u=s.itemSize,c=new ue(a,u);r==="color"&&(this._assignVertexColorSpace(c,s.vertexColorSpace),c.normalized=!(a instanceof Float32Array)),e.setAttribute(r,c)}return e}_assignVertexColorSpace(n,e){if(e!==V)return;const i=new X;for(let s=0,r=n.count;s<r;s++)i.fromBufferAttribute(n,s),Ke.toWorkingColorSpace(i,V),n.setXYZ(s,i.r,i.g,i.b)}_loadLibrary(n,e){const i=new we(this.manager);return i.setPath(this.decoderPath),i.setResponseType(e),i.setWithCredentials(this.withCredentials),new Promise((s,r)=>{i.load(n,s,void 0,r)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const n=typeof WebAssembly!="object"||this.decoderConfig.type==="js",e=[];return n?e.push(this._loadLibrary("draco_decoder.js","text")):(e.push(this._loadLibrary("draco_wasm_wrapper.js","text")),e.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(e).then(i=>{const s=i[0];n||(this.decoderConfig.wasmBinary=i[1]);const r=ys.toString(),a=["/* draco decoder */",s,"","/* worker */",r.substring(r.indexOf("{")+1,r.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a]))}),this.decoderPending}_getWorker(n,e){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const s=new Worker(this.workerSourceURL);s._callbacks={},s._taskCosts={},s._taskLoad=0,s.postMessage({type:"init",decoderConfig:this.decoderConfig}),s.onmessage=function(r){const a=r.data;switch(a.type){case"decode":s._callbacks[a.id].resolve(a);break;case"error":s._callbacks[a.id].reject(a);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+a.type+'"')}},this.workerPool.push(s)}else this.workerPool.sort(function(s,r){return s._taskLoad>r._taskLoad?-1:1});const i=this.workerPool[this.workerPool.length-1];return i._taskCosts[n]=e,i._taskLoad+=e,i})}_releaseTask(n,e){n._taskLoad-=n._taskCosts[e],delete n._callbacks[e],delete n._taskCosts[e]}debug(){console.log("Task load: ",this.workerPool.map(n=>n._taskLoad))}dispose(){for(let n=0;n<this.workerPool.length;++n)this.workerPool[n].terminate();return this.workerPool.length=0,this.workerSourceURL!==""&&URL.revokeObjectURL(this.workerSourceURL),this}}function ys(){let f,n;onmessage=function(a){const u=a.data;switch(u.type){case"init":f=u.decoderConfig,n=new Promise(function(_){f.onModuleLoaded=function(t){_({draco:t})},DracoDecoderModule(f)});break;case"decode":const c=u.buffer,d=u.taskConfig;n.then(_=>{const t=_.draco,o=new t.Decoder;try{const l=e(t,o,new Int8Array(c),d),h=l.attributes.map(m=>m.array.buffer);l.index&&h.push(l.index.array.buffer),self.postMessage({type:"decode",id:u.id,geometry:l},h)}catch(l){console.error(l),self.postMessage({type:"error",id:u.id,error:l.message})}finally{t.destroy(o)}});break}};function e(a,u,c,d){const _=d.attributeIDs,t=d.attributeTypes;let o,l;const h=u.GetEncodedGeometryType(c);if(h===a.TRIANGULAR_MESH)o=new a.Mesh,l=u.DecodeArrayToMesh(c,c.byteLength,o);else if(h===a.POINT_CLOUD)o=new a.PointCloud,l=u.DecodeArrayToPointCloud(c,c.byteLength,o);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!l.ok()||o.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+l.error_msg());const m={index:null,attributes:[]};for(const g in _){const p=self[t[g]];let y,T;if(d.useUniqueIDs)T=_[g],y=u.GetAttributeByUniqueId(o,T);else{if(T=u.GetAttributeId(o,a[_[g]]),T===-1)continue;y=u.GetAttribute(o,T)}const b=s(a,u,o,g,p,y);g==="color"&&(b.vertexColorSpace=d.vertexColorSpace),m.attributes.push(b)}return h===a.TRIANGULAR_MESH&&(m.index=i(a,u,o)),a.destroy(o),m}function i(a,u,c){const _=c.num_faces()*3,t=_*4,o=a._malloc(t);u.GetTrianglesUInt32Array(c,t,o);const l=new Uint32Array(a.HEAPF32.buffer,o,_).slice();return a._free(o),{array:l,itemSize:1}}function s(a,u,c,d,_,t){const o=t.num_components(),h=c.num_points()*o,m=h*_.BYTES_PER_ELEMENT,g=r(a,_),p=a._malloc(m);u.GetAttributeDataArrayForAllPoints(c,t,g,m,p);const y=new _(a.HEAPF32.buffer,p,h).slice();return a._free(p),{name:d,array:y,itemSize:o}}function r(a,u){switch(u){case Float32Array:return a.DT_FLOAT32;case Int8Array:return a.DT_INT8;case Int16Array:return a.DT_INT16;case Int32Array:return a.DT_INT32;case Uint8Array:return a.DT_UINT8;case Uint16Array:return a.DT_UINT16;case Uint32Array:return a.DT_UINT32}}}function Pt(f,n){if(n===yn)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),f;if(n===ze||n===Kt){let e=f.getIndex();if(e===null){const a=[],u=f.getAttribute("position");if(u!==void 0){for(let c=0;c<u.count;c++)a.push(c);f.setIndex(a),e=f.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),f}const i=e.count-2,s=[];if(n===ze)for(let a=1;a<=i;a++)s.push(e.getX(0)),s.push(e.getX(a)),s.push(e.getX(a+1));else for(let a=0;a<i;a++)a%2===0?(s.push(e.getX(a)),s.push(e.getX(a+1)),s.push(e.getX(a+2))):(s.push(e.getX(a+2)),s.push(e.getX(a+1)),s.push(e.getX(a)));s.length/3!==i&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=f.clone();return r.setIndex(s),r.clearGroups(),r}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",n),f}class Ts extends jt{constructor(n){super(n),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new As(e)}),this.register(function(e){return new Es(e)}),this.register(function(e){return new Os(e)}),this.register(function(e){return new Cs(e)}),this.register(function(e){return new Ns(e)}),this.register(function(e){return new Ms(e)}),this.register(function(e){return new Ls(e)}),this.register(function(e){return new Rs(e)}),this.register(function(e){return new Ds(e)}),this.register(function(e){return new xs(e)}),this.register(function(e){return new Ps(e)}),this.register(function(e){return new Ss(e)}),this.register(function(e){return new ks(e)}),this.register(function(e){return new Is(e)}),this.register(function(e){return new vs(e)}),this.register(function(e){return new Fs(e)}),this.register(function(e){return new Hs(e)})}load(n,e,i,s){const r=this;let a;if(this.resourcePath!=="")a=this.resourcePath;else if(this.path!==""){const d=de.extractUrlBase(n);a=de.resolveURL(d,this.path)}else a=de.extractUrlBase(n);this.manager.itemStart(n);const u=function(d){s?s(d):console.error(d),r.manager.itemError(n),r.manager.itemEnd(n)},c=new we(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(n,function(d){try{r.parse(d,a,function(_){e(_),r.manager.itemEnd(n)},u)}catch(_){u(_)}},i,u)}setDRACOLoader(n){return this.dracoLoader=n,this}setKTX2Loader(n){return this.ktx2Loader=n,this}setMeshoptDecoder(n){return this.meshoptDecoder=n,this}register(n){return this.pluginCallbacks.indexOf(n)===-1&&this.pluginCallbacks.push(n),this}unregister(n){return this.pluginCallbacks.indexOf(n)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(n),1),this}parse(n,e,i,s){let r;const a={},u={},c=new TextDecoder;if(typeof n=="string")r=JSON.parse(n);else if(n instanceof ArrayBuffer)if(c.decode(new Uint8Array(n,0,4))===Qt){try{a[v.KHR_BINARY_GLTF]=new Us(n)}catch(t){s&&s(t);return}r=JSON.parse(a[v.KHR_BINARY_GLTF].content)}else r=JSON.parse(c.decode(n));else r=n;if(r.asset===void 0||r.asset.version[0]<2){s&&s(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const d=new Qs(r,{path:e||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});d.fileLoader.setRequestHeader(this.requestHeader);for(let _=0;_<this.pluginCallbacks.length;_++){const t=this.pluginCallbacks[_](d);t.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),u[t.name]=t,a[t.name]=!0}if(r.extensionsUsed)for(let _=0;_<r.extensionsUsed.length;++_){const t=r.extensionsUsed[_],o=r.extensionsRequired||[];switch(t){case v.KHR_MATERIALS_UNLIT:a[t]=new ws;break;case v.KHR_DRACO_MESH_COMPRESSION:a[t]=new Bs(r,this.dracoLoader);break;case v.KHR_TEXTURE_TRANSFORM:a[t]=new js;break;case v.KHR_MESH_QUANTIZATION:a[t]=new Gs;break;default:o.indexOf(t)>=0&&u[t]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}d.setExtensions(a),d.setPlugins(u),d.parse(i,s)}parseAsync(n,e){const i=this;return new Promise(function(s,r){i.parse(n,e,s,r)})}}function bs(){let f={};return{get:function(n){return f[n]},add:function(n,e){f[n]=e},remove:function(n){delete f[n]},removeAll:function(){f={}}}}const v={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class vs{constructor(n){this.parser=n,this.name=v.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const n=this.parser,e=this.parser.json.nodes||[];for(let i=0,s=e.length;i<s;i++){const r=e[i];r.extensions&&r.extensions[this.name]&&r.extensions[this.name].light!==void 0&&n._addNodeRef(this.cache,r.extensions[this.name].light)}}_loadLight(n){const e=this.parser,i="light:"+n;let s=e.cache.get(i);if(s)return s;const r=e.json,c=((r.extensions&&r.extensions[this.name]||{}).lights||[])[n];let d;const _=new X(16777215);c.color!==void 0&&_.setRGB(c.color[0],c.color[1],c.color[2],U);const t=c.range!==void 0?c.range:0;switch(c.type){case"directional":d=new vn(_),d.target.position.set(0,0,-1),d.add(d.target);break;case"point":d=new bn(_),d.distance=t;break;case"spot":d=new Tn(_),d.distance=t,c.spot=c.spot||{},c.spot.innerConeAngle=c.spot.innerConeAngle!==void 0?c.spot.innerConeAngle:0,c.spot.outerConeAngle=c.spot.outerConeAngle!==void 0?c.spot.outerConeAngle:Math.PI/4,d.angle=c.spot.outerConeAngle,d.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,d.target.position.set(0,0,-1),d.add(d.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return d.position.set(0,0,0),K(d,c),c.intensity!==void 0&&(d.intensity=c.intensity),d.name=e.createUniqueName(c.name||"light_"+n),s=Promise.resolve(d),e.cache.add(i,s),s}getDependency(n,e){if(n==="light")return this._loadLight(e)}createNodeAttachment(n){const e=this,i=this.parser,r=i.json.nodes[n],u=(r.extensions&&r.extensions[this.name]||{}).light;return u===void 0?null:this._loadLight(u).then(function(c){return i._getNodeRef(e.cache,u,c)})}}class ws{constructor(){this.name=v.KHR_MATERIALS_UNLIT}getMaterialType(){return q}extendParams(n,e,i){const s=[];n.color=new X(1,1,1),n.opacity=1;const r=e.pbrMetallicRoughness;if(r){if(Array.isArray(r.baseColorFactor)){const a=r.baseColorFactor;n.color.setRGB(a[0],a[1],a[2],U),n.opacity=a[3]}r.baseColorTexture!==void 0&&s.push(i.assignTexture(n,"map",r.baseColorTexture,V))}return Promise.all(s)}}class xs{constructor(n){this.parser=n,this.name=v.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(n,e){const s=this.parser.json.materials[n];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name].emissiveStrength;return r!==void 0&&(e.emissiveIntensity=r),Promise.resolve()}}class As{constructor(n){this.parser=n,this.name=v.KHR_MATERIALS_CLEARCOAT}getMaterialType(n){const i=this.parser.json.materials[n];return!i.extensions||!i.extensions[this.name]?null:B}extendMaterialParams(n,e){const i=this.parser,s=i.json.materials[n];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],a=s.extensions[this.name];if(a.clearcoatFactor!==void 0&&(e.clearcoat=a.clearcoatFactor),a.clearcoatTexture!==void 0&&r.push(i.assignTexture(e,"clearcoatMap",a.clearcoatTexture)),a.clearcoatRoughnessFactor!==void 0&&(e.clearcoatRoughness=a.clearcoatRoughnessFactor),a.clearcoatRoughnessTexture!==void 0&&r.push(i.assignTexture(e,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),a.clearcoatNormalTexture!==void 0&&(r.push(i.assignTexture(e,"clearcoatNormalMap",a.clearcoatNormalTexture)),a.clearcoatNormalTexture.scale!==void 0)){const u=a.clearcoatNormalTexture.scale;e.clearcoatNormalScale=new D(u,u)}return Promise.all(r)}}class Es{constructor(n){this.parser=n,this.name=v.KHR_MATERIALS_DISPERSION}getMaterialType(n){const i=this.parser.json.materials[n];return!i.extensions||!i.extensions[this.name]?null:B}extendMaterialParams(n,e){const s=this.parser.json.materials[n];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name];return e.dispersion=r.dispersion!==void 0?r.dispersion:0,Promise.resolve()}}class Ss{constructor(n){this.parser=n,this.name=v.KHR_MATERIALS_IRIDESCENCE}getMaterialType(n){const i=this.parser.json.materials[n];return!i.extensions||!i.extensions[this.name]?null:B}extendMaterialParams(n,e){const i=this.parser,s=i.json.materials[n];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],a=s.extensions[this.name];return a.iridescenceFactor!==void 0&&(e.iridescence=a.iridescenceFactor),a.iridescenceTexture!==void 0&&r.push(i.assignTexture(e,"iridescenceMap",a.iridescenceTexture)),a.iridescenceIor!==void 0&&(e.iridescenceIOR=a.iridescenceIor),e.iridescenceThicknessRange===void 0&&(e.iridescenceThicknessRange=[100,400]),a.iridescenceThicknessMinimum!==void 0&&(e.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),a.iridescenceThicknessMaximum!==void 0&&(e.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),a.iridescenceThicknessTexture!==void 0&&r.push(i.assignTexture(e,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(r)}}class Ms{constructor(n){this.parser=n,this.name=v.KHR_MATERIALS_SHEEN}getMaterialType(n){const i=this.parser.json.materials[n];return!i.extensions||!i.extensions[this.name]?null:B}extendMaterialParams(n,e){const i=this.parser,s=i.json.materials[n];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[];e.sheenColor=new X(0,0,0),e.sheenRoughness=0,e.sheen=1;const a=s.extensions[this.name];if(a.sheenColorFactor!==void 0){const u=a.sheenColorFactor;e.sheenColor.setRGB(u[0],u[1],u[2],U)}return a.sheenRoughnessFactor!==void 0&&(e.sheenRoughness=a.sheenRoughnessFactor),a.sheenColorTexture!==void 0&&r.push(i.assignTexture(e,"sheenColorMap",a.sheenColorTexture,V)),a.sheenRoughnessTexture!==void 0&&r.push(i.assignTexture(e,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(r)}}class Ls{constructor(n){this.parser=n,this.name=v.KHR_MATERIALS_TRANSMISSION}getMaterialType(n){const i=this.parser.json.materials[n];return!i.extensions||!i.extensions[this.name]?null:B}extendMaterialParams(n,e){const i=this.parser,s=i.json.materials[n];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],a=s.extensions[this.name];return a.transmissionFactor!==void 0&&(e.transmission=a.transmissionFactor),a.transmissionTexture!==void 0&&r.push(i.assignTexture(e,"transmissionMap",a.transmissionTexture)),Promise.all(r)}}class Rs{constructor(n){this.parser=n,this.name=v.KHR_MATERIALS_VOLUME}getMaterialType(n){const i=this.parser.json.materials[n];return!i.extensions||!i.extensions[this.name]?null:B}extendMaterialParams(n,e){const i=this.parser,s=i.json.materials[n];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],a=s.extensions[this.name];e.thickness=a.thicknessFactor!==void 0?a.thicknessFactor:0,a.thicknessTexture!==void 0&&r.push(i.assignTexture(e,"thicknessMap",a.thicknessTexture)),e.attenuationDistance=a.attenuationDistance||1/0;const u=a.attenuationColor||[1,1,1];return e.attenuationColor=new X().setRGB(u[0],u[1],u[2],U),Promise.all(r)}}class Ds{constructor(n){this.parser=n,this.name=v.KHR_MATERIALS_IOR}getMaterialType(n){const i=this.parser.json.materials[n];return!i.extensions||!i.extensions[this.name]?null:B}extendMaterialParams(n,e){const s=this.parser.json.materials[n];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=s.extensions[this.name];return e.ior=r.ior!==void 0?r.ior:1.5,Promise.resolve()}}class Ps{constructor(n){this.parser=n,this.name=v.KHR_MATERIALS_SPECULAR}getMaterialType(n){const i=this.parser.json.materials[n];return!i.extensions||!i.extensions[this.name]?null:B}extendMaterialParams(n,e){const i=this.parser,s=i.json.materials[n];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],a=s.extensions[this.name];e.specularIntensity=a.specularFactor!==void 0?a.specularFactor:1,a.specularTexture!==void 0&&r.push(i.assignTexture(e,"specularIntensityMap",a.specularTexture));const u=a.specularColorFactor||[1,1,1];return e.specularColor=new X().setRGB(u[0],u[1],u[2],U),a.specularColorTexture!==void 0&&r.push(i.assignTexture(e,"specularColorMap",a.specularColorTexture,V)),Promise.all(r)}}class Is{constructor(n){this.parser=n,this.name=v.EXT_MATERIALS_BUMP}getMaterialType(n){const i=this.parser.json.materials[n];return!i.extensions||!i.extensions[this.name]?null:B}extendMaterialParams(n,e){const i=this.parser,s=i.json.materials[n];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],a=s.extensions[this.name];return e.bumpScale=a.bumpFactor!==void 0?a.bumpFactor:1,a.bumpTexture!==void 0&&r.push(i.assignTexture(e,"bumpMap",a.bumpTexture)),Promise.all(r)}}class ks{constructor(n){this.parser=n,this.name=v.KHR_MATERIALS_ANISOTROPY}getMaterialType(n){const i=this.parser.json.materials[n];return!i.extensions||!i.extensions[this.name]?null:B}extendMaterialParams(n,e){const i=this.parser,s=i.json.materials[n];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const r=[],a=s.extensions[this.name];return a.anisotropyStrength!==void 0&&(e.anisotropy=a.anisotropyStrength),a.anisotropyRotation!==void 0&&(e.anisotropyRotation=a.anisotropyRotation),a.anisotropyTexture!==void 0&&r.push(i.assignTexture(e,"anisotropyMap",a.anisotropyTexture)),Promise.all(r)}}class Os{constructor(n){this.parser=n,this.name=v.KHR_TEXTURE_BASISU}loadTexture(n){const e=this.parser,i=e.json,s=i.textures[n];if(!s.extensions||!s.extensions[this.name])return null;const r=s.extensions[this.name],a=e.options.ktx2Loader;if(!a){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return e.loadTextureImage(n,r.source,a)}}class Cs{constructor(n){this.parser=n,this.name=v.EXT_TEXTURE_WEBP}loadTexture(n){const e=this.name,i=this.parser,s=i.json,r=s.textures[n];if(!r.extensions||!r.extensions[e])return null;const a=r.extensions[e],u=s.images[a.source];let c=i.textureLoader;if(u.uri){const d=i.options.manager.getHandler(u.uri);d!==null&&(c=d)}return i.loadTextureImage(n,a.source,c)}}class Ns{constructor(n){this.parser=n,this.name=v.EXT_TEXTURE_AVIF}loadTexture(n){const e=this.name,i=this.parser,s=i.json,r=s.textures[n];if(!r.extensions||!r.extensions[e])return null;const a=r.extensions[e],u=s.images[a.source];let c=i.textureLoader;if(u.uri){const d=i.options.manager.getHandler(u.uri);d!==null&&(c=d)}return i.loadTextureImage(n,a.source,c)}}class Fs{constructor(n){this.name=v.EXT_MESHOPT_COMPRESSION,this.parser=n}loadBufferView(n){const e=this.parser.json,i=e.bufferViews[n];if(i.extensions&&i.extensions[this.name]){const s=i.extensions[this.name],r=this.parser.getDependency("buffer",s.buffer),a=this.parser.options.meshoptDecoder;if(!a||!a.supported){if(e.extensionsRequired&&e.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return r.then(function(u){const c=s.byteOffset||0,d=s.byteLength||0,_=s.count,t=s.byteStride,o=new Uint8Array(u,c,d);return a.decodeGltfBufferAsync?a.decodeGltfBufferAsync(_,t,o,s.mode,s.filter).then(function(l){return l.buffer}):a.ready.then(function(){const l=new ArrayBuffer(_*t);return a.decodeGltfBuffer(new Uint8Array(l),_,t,o,s.mode,s.filter),l})})}else return null}}class Hs{constructor(n){this.name=v.EXT_MESH_GPU_INSTANCING,this.parser=n}createNodeMesh(n){const e=this.parser.json,i=e.nodes[n];if(!i.extensions||!i.extensions[this.name]||i.mesh===void 0)return null;const s=e.meshes[i.mesh];for(const d of s.primitives)if(d.mode!==O.TRIANGLES&&d.mode!==O.TRIANGLE_STRIP&&d.mode!==O.TRIANGLE_FAN&&d.mode!==void 0)return null;const a=i.extensions[this.name].attributes,u=[],c={};for(const d in a)u.push(this.parser.getDependency("accessor",a[d]).then(_=>(c[d]=_,c[d])));return u.length<1?null:(u.push(this.parser.createNodeMesh(n)),Promise.all(u).then(d=>{const _=d.pop(),t=_.isGroup?_.children:[_],o=d[0].count,l=[];for(const h of t){const m=new xe,g=new S,p=new be,y=new S(1,1,1),T=new wn(h.geometry,h.material,o);for(let b=0;b<o;b++)c.TRANSLATION&&g.fromBufferAttribute(c.TRANSLATION,b),c.ROTATION&&p.fromBufferAttribute(c.ROTATION,b),c.SCALE&&y.fromBufferAttribute(c.SCALE,b),T.setMatrixAt(b,m.compose(g,p,y));for(const b in c)if(b==="_COLOR_0"){const A=c[b];T.instanceColor=new xn(A.array,A.itemSize,A.normalized)}else b!=="TRANSLATION"&&b!=="ROTATION"&&b!=="SCALE"&&h.geometry.setAttribute(b,c[b]);zt.prototype.copy.call(T,h),this.parser.assignFinalMaterial(T),l.push(T)}return _.isGroup?(_.clear(),_.add(...l),_):l[0]}))}}const Qt="glTF",ae=12,It={JSON:1313821514,BIN:5130562};class Us{constructor(n){this.name=v.KHR_BINARY_GLTF,this.content=null,this.body=null;const e=new DataView(n,0,ae),i=new TextDecoder;if(this.header={magic:i.decode(new Uint8Array(n.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==Qt)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const s=this.header.length-ae,r=new DataView(n,ae);let a=0;for(;a<s;){const u=r.getUint32(a,!0);a+=4;const c=r.getUint32(a,!0);if(a+=4,c===It.JSON){const d=new Uint8Array(n,ae+a,u);this.content=i.decode(d)}else if(c===It.BIN){const d=ae+a;this.body=n.slice(d,d+u)}a+=u}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class Bs{constructor(n,e){if(!e)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=v.KHR_DRACO_MESH_COMPRESSION,this.json=n,this.dracoLoader=e,this.dracoLoader.preload()}decodePrimitive(n,e){const i=this.json,s=this.dracoLoader,r=n.extensions[this.name].bufferView,a=n.extensions[this.name].attributes,u={},c={},d={};for(const _ in a){const t=Ve[_]||_.toLowerCase();u[t]=a[_]}for(const _ in n.attributes){const t=Ve[_]||_.toLowerCase();if(a[_]!==void 0){const o=i.accessors[n.attributes[_]],l=oe[o.componentType];d[t]=l.name,c[t]=o.normalized===!0}}return e.getDependency("bufferView",r).then(function(_){return new Promise(function(t,o){s.decodeDracoFile(_,function(l){for(const h in l.attributes){const m=l.attributes[h],g=c[h];g!==void 0&&(m.normalized=g)}t(l)},u,d,U,o)})})}}class js{constructor(){this.name=v.KHR_TEXTURE_TRANSFORM}extendTexture(n,e){return(e.texCoord===void 0||e.texCoord===n.channel)&&e.offset===void 0&&e.rotation===void 0&&e.scale===void 0||(n=n.clone(),e.texCoord!==void 0&&(n.channel=e.texCoord),e.offset!==void 0&&n.offset.fromArray(e.offset),e.rotation!==void 0&&(n.rotation=e.rotation),e.scale!==void 0&&n.repeat.fromArray(e.scale),n.needsUpdate=!0),n}}class Gs{constructor(){this.name=v.KHR_MESH_QUANTIZATION}}class $t extends Xn{constructor(n,e,i,s){super(n,e,i,s)}copySampleValue_(n){const e=this.resultBuffer,i=this.sampleValues,s=this.valueSize,r=n*s*3+s;for(let a=0;a!==s;a++)e[a]=i[r+a];return e}interpolate_(n,e,i,s){const r=this.resultBuffer,a=this.sampleValues,u=this.valueSize,c=u*2,d=u*3,_=s-e,t=(i-e)/_,o=t*t,l=o*t,h=n*d,m=h-d,g=-2*l+3*o,p=l-o,y=1-g,T=p-o+t;for(let b=0;b!==u;b++){const A=a[m+b+u],L=a[m+b+c]*_,M=a[h+b+u],j=a[h+b]*_;r[b]=y*A+T*L+g*M+p*j}return r}}const Ks=new be;class zs extends $t{interpolate_(n,e,i,s){const r=super.interpolate_(n,e,i,s);return Ks.fromArray(r).normalize().toArray(r),r}}const O={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},oe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},kt={9728:Yt,9729:Ae,9984:Ln,9985:Mn,9986:Sn,9987:Xt},Ot={33071:Dn,33648:Rn,10497:fe},Ce={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ve={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Y={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Vs={CUBICSPLINE:void 0,LINEAR:Zt,STEP:Kn},Ne={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Xs(f){return f.DefaultMaterial===void 0&&(f.DefaultMaterial=new ht({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Vn})),f.DefaultMaterial}function Z(f,n,e){for(const i in e.extensions)f[i]===void 0&&(n.userData.gltfExtensions=n.userData.gltfExtensions||{},n.userData.gltfExtensions[i]=e.extensions[i])}function K(f,n){n.extras!==void 0&&(typeof n.extras=="object"?Object.assign(f.userData,n.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+n.extras))}function Ys(f,n,e){let i=!1,s=!1,r=!1;for(let d=0,_=n.length;d<_;d++){const t=n[d];if(t.POSITION!==void 0&&(i=!0),t.NORMAL!==void 0&&(s=!0),t.COLOR_0!==void 0&&(r=!0),i&&s&&r)break}if(!i&&!s&&!r)return Promise.resolve(f);const a=[],u=[],c=[];for(let d=0,_=n.length;d<_;d++){const t=n[d];if(i){const o=t.POSITION!==void 0?e.getDependency("accessor",t.POSITION):f.attributes.position;a.push(o)}if(s){const o=t.NORMAL!==void 0?e.getDependency("accessor",t.NORMAL):f.attributes.normal;u.push(o)}if(r){const o=t.COLOR_0!==void 0?e.getDependency("accessor",t.COLOR_0):f.attributes.color;c.push(o)}}return Promise.all([Promise.all(a),Promise.all(u),Promise.all(c)]).then(function(d){const _=d[0],t=d[1],o=d[2];return i&&(f.morphAttributes.position=_),s&&(f.morphAttributes.normal=t),r&&(f.morphAttributes.color=o),f.morphTargetsRelative=!0,f})}function qs(f,n){if(f.updateMorphTargets(),n.weights!==void 0)for(let e=0,i=n.weights.length;e<i;e++)f.morphTargetInfluences[e]=n.weights[e];if(n.extras&&Array.isArray(n.extras.targetNames)){const e=n.extras.targetNames;if(f.morphTargetInfluences.length===e.length){f.morphTargetDictionary={};for(let i=0,s=e.length;i<s;i++)f.morphTargetDictionary[e[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Ws(f){let n;const e=f.extensions&&f.extensions[v.KHR_DRACO_MESH_COMPRESSION];if(e?n="draco:"+e.bufferView+":"+e.indices+":"+Fe(e.attributes):n=f.indices+":"+Fe(f.attributes)+":"+f.mode,f.targets!==void 0)for(let i=0,s=f.targets.length;i<s;i++)n+=":"+Fe(f.targets[i]);return n}function Fe(f){let n="";const e=Object.keys(f).sort();for(let i=0,s=e.length;i<s;i++)n+=e[i]+":"+f[e[i]]+";";return n}function Xe(f){switch(f){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}function Zs(f){return f.search(/\.jpe?g($|\?)/i)>0||f.search(/^data\:image\/jpeg/)===0?"image/jpeg":f.search(/\.webp($|\?)/i)>0||f.search(/^data\:image\/webp/)===0?"image/webp":f.search(/\.ktx2($|\?)/i)>0||f.search(/^data\:image\/ktx2/)===0?"image/ktx2":"image/png"}const Js=new xe;class Qs{constructor(n={},e={}){this.json=n,this.extensions={},this.plugins={},this.options=e,this.cache=new bs,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,s=-1,r=!1,a=-1;if(typeof navigator<"u"){const u=navigator.userAgent;i=/^((?!chrome|android).)*safari/i.test(u)===!0;const c=u.match(/Version\/(\d+)/);s=i&&c?parseInt(c[1],10):-1,r=u.indexOf("Firefox")>-1,a=r?u.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||i&&s<17||r&&a<98?this.textureLoader=new Vt(this.options.manager):this.textureLoader=new An(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new we(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(n){this.extensions=n}setPlugins(n){this.plugins=n}parse(n,e){const i=this,s=this.json,r=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(a){return a._markDefs&&a._markDefs()}),Promise.all(this._invokeAll(function(a){return a.beforeRoot&&a.beforeRoot()})).then(function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])}).then(function(a){const u={scene:a[0][s.scene||0],scenes:a[0],animations:a[1],cameras:a[2],asset:s.asset,parser:i,userData:{}};return Z(r,u,s),K(u,s),Promise.all(i._invokeAll(function(c){return c.afterRoot&&c.afterRoot(u)})).then(function(){for(const c of u.scenes)c.updateMatrixWorld();n(u)})}).catch(e)}_markDefs(){const n=this.json.nodes||[],e=this.json.skins||[],i=this.json.meshes||[];for(let s=0,r=e.length;s<r;s++){const a=e[s].joints;for(let u=0,c=a.length;u<c;u++)n[a[u]].isBone=!0}for(let s=0,r=n.length;s<r;s++){const a=n[s];a.mesh!==void 0&&(this._addNodeRef(this.meshCache,a.mesh),a.skin!==void 0&&(i[a.mesh].isSkinnedMesh=!0)),a.camera!==void 0&&this._addNodeRef(this.cameraCache,a.camera)}}_addNodeRef(n,e){e!==void 0&&(n.refs[e]===void 0&&(n.refs[e]=n.uses[e]=0),n.refs[e]++)}_getNodeRef(n,e,i){if(n.refs[e]<=1)return i;const s=i.clone(),r=(a,u)=>{const c=this.associations.get(a);c!=null&&this.associations.set(u,c);for(const[d,_]of a.children.entries())r(_,u.children[d])};return r(i,s),s.name+="_instance_"+n.uses[e]++,s}_invokeOne(n){const e=Object.values(this.plugins);e.push(this);for(let i=0;i<e.length;i++){const s=n(e[i]);if(s)return s}return null}_invokeAll(n){const e=Object.values(this.plugins);e.unshift(this);const i=[];for(let s=0;s<e.length;s++){const r=n(e[s]);r&&i.push(r)}return i}getDependency(n,e){const i=n+":"+e;let s=this.cache.get(i);if(!s){switch(n){case"scene":s=this.loadScene(e);break;case"node":s=this._invokeOne(function(r){return r.loadNode&&r.loadNode(e)});break;case"mesh":s=this._invokeOne(function(r){return r.loadMesh&&r.loadMesh(e)});break;case"accessor":s=this.loadAccessor(e);break;case"bufferView":s=this._invokeOne(function(r){return r.loadBufferView&&r.loadBufferView(e)});break;case"buffer":s=this.loadBuffer(e);break;case"material":s=this._invokeOne(function(r){return r.loadMaterial&&r.loadMaterial(e)});break;case"texture":s=this._invokeOne(function(r){return r.loadTexture&&r.loadTexture(e)});break;case"skin":s=this.loadSkin(e);break;case"animation":s=this._invokeOne(function(r){return r.loadAnimation&&r.loadAnimation(e)});break;case"camera":s=this.loadCamera(e);break;default:if(s=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(n,e)}),!s)throw new Error("Unknown type: "+n);break}this.cache.add(i,s)}return s}getDependencies(n){let e=this.cache.get(n);if(!e){const i=this,s=this.json[n+(n==="mesh"?"es":"s")]||[];e=Promise.all(s.map(function(r,a){return i.getDependency(n,a)})),this.cache.add(n,e)}return e}loadBuffer(n){const e=this.json.buffers[n],i=this.fileLoader;if(e.type&&e.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+e.type+" buffer type is not supported.");if(e.uri===void 0&&n===0)return Promise.resolve(this.extensions[v.KHR_BINARY_GLTF].body);const s=this.options;return new Promise(function(r,a){i.load(de.resolveURL(e.uri,s.path),r,void 0,function(){a(new Error('THREE.GLTFLoader: Failed to load buffer "'+e.uri+'".'))})})}loadBufferView(n){const e=this.json.bufferViews[n];return this.getDependency("buffer",e.buffer).then(function(i){const s=e.byteLength||0,r=e.byteOffset||0;return i.slice(r,r+s)})}loadAccessor(n){const e=this,i=this.json,s=this.json.accessors[n];if(s.bufferView===void 0&&s.sparse===void 0){const a=Ce[s.type],u=oe[s.componentType],c=s.normalized===!0,d=new u(s.count*a);return Promise.resolve(new ue(d,a,c))}const r=[];return s.bufferView!==void 0?r.push(this.getDependency("bufferView",s.bufferView)):r.push(null),s.sparse!==void 0&&(r.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),r.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(r).then(function(a){const u=a[0],c=Ce[s.type],d=oe[s.componentType],_=d.BYTES_PER_ELEMENT,t=_*c,o=s.byteOffset||0,l=s.bufferView!==void 0?i.bufferViews[s.bufferView].byteStride:void 0,h=s.normalized===!0;let m,g;if(l&&l!==t){const p=Math.floor(o/l),y="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+p+":"+s.count;let T=e.cache.get(y);T||(m=new d(u,p*l,s.count*l/_),T=new En(m,l/_),e.cache.add(y,T)),g=new zn(T,c,o%l/_,h)}else u===null?m=new d(s.count*c):m=new d(u,o,s.count*c),g=new ue(m,c,h);if(s.sparse!==void 0){const p=Ce.SCALAR,y=oe[s.sparse.indices.componentType],T=s.sparse.indices.byteOffset||0,b=s.sparse.values.byteOffset||0,A=new y(a[1],T,s.sparse.count*p),L=new d(a[2],b,s.sparse.count*c);u!==null&&(g=new ue(g.array.slice(),g.itemSize,g.normalized)),g.normalized=!1;for(let M=0,j=A.length;M<j;M++){const w=A[M];if(g.setX(w,L[M*c]),c>=2&&g.setY(w,L[M*c+1]),c>=3&&g.setZ(w,L[M*c+2]),c>=4&&g.setW(w,L[M*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}g.normalized=h}return g})}loadTexture(n){const e=this.json,i=this.options,r=e.textures[n].source,a=e.images[r];let u=this.textureLoader;if(a.uri){const c=i.manager.getHandler(a.uri);c!==null&&(u=c)}return this.loadTextureImage(n,r,u)}loadTextureImage(n,e,i){const s=this,r=this.json,a=r.textures[n],u=r.images[e],c=(u.uri||u.bufferView)+":"+a.sampler;if(this.textureCache[c])return this.textureCache[c];const d=this.loadImageSource(e,i).then(function(_){_.flipY=!1,_.name=a.name||u.name||"",_.name===""&&typeof u.uri=="string"&&u.uri.startsWith("data:image/")===!1&&(_.name=u.uri);const o=(r.samplers||{})[a.sampler]||{};return _.magFilter=kt[o.magFilter]||Ae,_.minFilter=kt[o.minFilter]||Xt,_.wrapS=Ot[o.wrapS]||fe,_.wrapT=Ot[o.wrapT]||fe,_.generateMipmaps=!_.isCompressedTexture&&_.minFilter!==Yt&&_.minFilter!==Ae,s.associations.set(_,{textures:n}),_}).catch(function(){return null});return this.textureCache[c]=d,d}loadImageSource(n,e){const i=this,s=this.json,r=this.options;if(this.sourceCache[n]!==void 0)return this.sourceCache[n].then(t=>t.clone());const a=s.images[n],u=self.URL||self.webkitURL;let c=a.uri||"",d=!1;if(a.bufferView!==void 0)c=i.getDependency("bufferView",a.bufferView).then(function(t){d=!0;const o=new Blob([t],{type:a.mimeType});return c=u.createObjectURL(o),c});else if(a.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+n+" is missing URI and bufferView");const _=Promise.resolve(c).then(function(t){return new Promise(function(o,l){let h=o;e.isImageBitmapLoader===!0&&(h=function(m){const g=new At(m);g.needsUpdate=!0,o(g)}),e.load(de.resolveURL(t,r.path),h,void 0,l)})}).then(function(t){return d===!0&&u.revokeObjectURL(c),K(t,a),t.userData.mimeType=a.mimeType||Zs(a.uri),t}).catch(function(t){throw console.error("THREE.GLTFLoader: Couldn't load texture",c),t});return this.sourceCache[n]=_,_}assignTexture(n,e,i,s){const r=this;return this.getDependency("texture",i.index).then(function(a){if(!a)return null;if(i.texCoord!==void 0&&i.texCoord>0&&(a=a.clone(),a.channel=i.texCoord),r.extensions[v.KHR_TEXTURE_TRANSFORM]){const u=i.extensions!==void 0?i.extensions[v.KHR_TEXTURE_TRANSFORM]:void 0;if(u){const c=r.associations.get(a);a=r.extensions[v.KHR_TEXTURE_TRANSFORM].extendTexture(a,u),r.associations.set(a,c)}}return s!==void 0&&(a.colorSpace=s),n[e]=a,a})}assignFinalMaterial(n){const e=n.geometry;let i=n.material;const s=e.attributes.tangent===void 0,r=e.attributes.color!==void 0,a=e.attributes.normal===void 0;if(n.isPoints){const u="PointsMaterial:"+i.uuid;let c=this.cache.get(u);c||(c=new Pn,Pe.prototype.copy.call(c,i),c.color.copy(i.color),c.map=i.map,c.sizeAttenuation=!1,this.cache.add(u,c)),i=c}else if(n.isLine){const u="LineBasicMaterial:"+i.uuid;let c=this.cache.get(u);c||(c=new In,Pe.prototype.copy.call(c,i),c.color.copy(i.color),c.map=i.map,this.cache.add(u,c)),i=c}if(s||r||a){let u="ClonedMaterial:"+i.uuid+":";s&&(u+="derivative-tangents:"),r&&(u+="vertex-colors:"),a&&(u+="flat-shading:");let c=this.cache.get(u);c||(c=i.clone(),r&&(c.vertexColors=!0),a&&(c.flatShading=!0),s&&(c.normalScale&&(c.normalScale.y*=-1),c.clearcoatNormalScale&&(c.clearcoatNormalScale.y*=-1)),this.cache.add(u,c),this.associations.set(c,this.associations.get(i))),i=c}n.material=i}getMaterialType(){return ht}loadMaterial(n){const e=this,i=this.json,s=this.extensions,r=i.materials[n];let a;const u={},c=r.extensions||{},d=[];if(c[v.KHR_MATERIALS_UNLIT]){const t=s[v.KHR_MATERIALS_UNLIT];a=t.getMaterialType(),d.push(t.extendParams(u,r,e))}else{const t=r.pbrMetallicRoughness||{};if(u.color=new X(1,1,1),u.opacity=1,Array.isArray(t.baseColorFactor)){const o=t.baseColorFactor;u.color.setRGB(o[0],o[1],o[2],U),u.opacity=o[3]}t.baseColorTexture!==void 0&&d.push(e.assignTexture(u,"map",t.baseColorTexture,V)),u.metalness=t.metallicFactor!==void 0?t.metallicFactor:1,u.roughness=t.roughnessFactor!==void 0?t.roughnessFactor:1,t.metallicRoughnessTexture!==void 0&&(d.push(e.assignTexture(u,"metalnessMap",t.metallicRoughnessTexture)),d.push(e.assignTexture(u,"roughnessMap",t.metallicRoughnessTexture))),a=this._invokeOne(function(o){return o.getMaterialType&&o.getMaterialType(n)}),d.push(Promise.all(this._invokeAll(function(o){return o.extendMaterialParams&&o.extendMaterialParams(n,u)})))}r.doubleSided===!0&&(u.side=qt);const _=r.alphaMode||Ne.OPAQUE;if(_===Ne.BLEND?(u.transparent=!0,u.depthWrite=!1):(u.transparent=!1,_===Ne.MASK&&(u.alphaTest=r.alphaCutoff!==void 0?r.alphaCutoff:.5)),r.normalTexture!==void 0&&a!==q&&(d.push(e.assignTexture(u,"normalMap",r.normalTexture)),u.normalScale=new D(1,1),r.normalTexture.scale!==void 0)){const t=r.normalTexture.scale;u.normalScale.set(t,t)}if(r.occlusionTexture!==void 0&&a!==q&&(d.push(e.assignTexture(u,"aoMap",r.occlusionTexture)),r.occlusionTexture.strength!==void 0&&(u.aoMapIntensity=r.occlusionTexture.strength)),r.emissiveFactor!==void 0&&a!==q){const t=r.emissiveFactor;u.emissive=new X().setRGB(t[0],t[1],t[2],U)}return r.emissiveTexture!==void 0&&a!==q&&d.push(e.assignTexture(u,"emissiveMap",r.emissiveTexture,V)),Promise.all(d).then(function(){const t=new a(u);return r.name&&(t.name=r.name),K(t,r),e.associations.set(t,{materials:n}),r.extensions&&Z(s,t,r),t})}createUniqueName(n){const e=kn.sanitizeNodeName(n||"");return e in this.nodeNamesUsed?e+"_"+ ++this.nodeNamesUsed[e]:(this.nodeNamesUsed[e]=0,e)}loadGeometries(n){const e=this,i=this.extensions,s=this.primitiveCache;function r(u){return i[v.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(u,e).then(function(c){return Ct(c,u,e)})}const a=[];for(let u=0,c=n.length;u<c;u++){const d=n[u],_=Ws(d),t=s[_];if(t)a.push(t.promise);else{let o;d.extensions&&d.extensions[v.KHR_DRACO_MESH_COMPRESSION]?o=r(d):o=Ct(new Gt,d,e),s[_]={primitive:d,promise:o},a.push(o)}}return Promise.all(a)}loadMesh(n){const e=this,i=this.json,s=this.extensions,r=i.meshes[n],a=r.primitives,u=[];for(let c=0,d=a.length;c<d;c++){const _=a[c].material===void 0?Xs(this.cache):this.getDependency("material",a[c].material);u.push(_)}return u.push(e.loadGeometries(a)),Promise.all(u).then(function(c){const d=c.slice(0,c.length-1),_=c[c.length-1],t=[];for(let l=0,h=_.length;l<h;l++){const m=_[l],g=a[l];let p;const y=d[l];if(g.mode===O.TRIANGLES||g.mode===O.TRIANGLE_STRIP||g.mode===O.TRIANGLE_FAN||g.mode===void 0)p=r.isSkinnedMesh===!0?new On(m,y):new pe(m,y),p.isSkinnedMesh===!0&&p.normalizeSkinWeights(),g.mode===O.TRIANGLE_STRIP?p.geometry=Pt(p.geometry,Kt):g.mode===O.TRIANGLE_FAN&&(p.geometry=Pt(p.geometry,ze));else if(g.mode===O.LINES)p=new Cn(m,y);else if(g.mode===O.LINE_STRIP)p=new Nn(m,y);else if(g.mode===O.LINE_LOOP)p=new Fn(m,y);else if(g.mode===O.POINTS)p=new Hn(m,y);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+g.mode);Object.keys(p.geometry.morphAttributes).length>0&&qs(p,r),p.name=e.createUniqueName(r.name||"mesh_"+n),K(p,r),g.extensions&&Z(s,p,g),e.assignFinalMaterial(p),t.push(p)}for(let l=0,h=t.length;l<h;l++)e.associations.set(t[l],{meshes:n,primitives:l});if(t.length===1)return r.extensions&&Z(s,t[0],r),t[0];const o=new Ie;r.extensions&&Z(s,o,r),e.associations.set(o,{meshes:n});for(let l=0,h=t.length;l<h;l++)o.add(t[l]);return o})}loadCamera(n){let e;const i=this.json.cameras[n],s=i[i.type];if(!s){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return i.type==="perspective"?e=new Wt(ve.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):i.type==="orthographic"&&(e=new Un(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),i.name&&(e.name=this.createUniqueName(i.name)),K(e,i),Promise.resolve(e)}loadSkin(n){const e=this.json.skins[n],i=[];for(let s=0,r=e.joints.length;s<r;s++)i.push(this._loadNodeShallow(e.joints[s]));return e.inverseBindMatrices!==void 0?i.push(this.getDependency("accessor",e.inverseBindMatrices)):i.push(null),Promise.all(i).then(function(s){const r=s.pop(),a=s,u=[],c=[];for(let d=0,_=a.length;d<_;d++){const t=a[d];if(t){u.push(t);const o=new xe;r!==null&&o.fromArray(r.array,d*16),c.push(o)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',e.joints[d])}return new Bn(u,c)})}loadAnimation(n){const e=this.json,i=this,s=e.animations[n],r=s.name?s.name:"animation_"+n,a=[],u=[],c=[],d=[],_=[];for(let t=0,o=s.channels.length;t<o;t++){const l=s.channels[t],h=s.samplers[l.sampler],m=l.target,g=m.node,p=s.parameters!==void 0?s.parameters[h.input]:h.input,y=s.parameters!==void 0?s.parameters[h.output]:h.output;m.node!==void 0&&(a.push(this.getDependency("node",g)),u.push(this.getDependency("accessor",p)),c.push(this.getDependency("accessor",y)),d.push(h),_.push(m))}return Promise.all([Promise.all(a),Promise.all(u),Promise.all(c),Promise.all(d),Promise.all(_)]).then(function(t){const o=t[0],l=t[1],h=t[2],m=t[3],g=t[4],p=[];for(let y=0,T=o.length;y<T;y++){const b=o[y],A=l[y],L=h[y],M=m[y],j=g[y];if(b===void 0)continue;b.updateMatrix&&b.updateMatrix();const w=i._createAnimationTracks(b,A,L,M,j);if(w)for(let $=0;$<w.length;$++)p.push(w[$])}return new jn(r,void 0,p)})}createNodeMesh(n){const e=this.json,i=this,s=e.nodes[n];return s.mesh===void 0?null:i.getDependency("mesh",s.mesh).then(function(r){const a=i._getNodeRef(i.meshCache,s.mesh,r);return s.weights!==void 0&&a.traverse(function(u){if(u.isMesh)for(let c=0,d=s.weights.length;c<d;c++)u.morphTargetInfluences[c]=s.weights[c]}),a})}loadNode(n){const e=this.json,i=this,s=e.nodes[n],r=i._loadNodeShallow(n),a=[],u=s.children||[];for(let d=0,_=u.length;d<_;d++)a.push(i.getDependency("node",u[d]));const c=s.skin===void 0?Promise.resolve(null):i.getDependency("skin",s.skin);return Promise.all([r,Promise.all(a),c]).then(function(d){const _=d[0],t=d[1],o=d[2];o!==null&&_.traverse(function(l){l.isSkinnedMesh&&l.bind(o,Js)});for(let l=0,h=t.length;l<h;l++)_.add(t[l]);return _})}_loadNodeShallow(n){const e=this.json,i=this.extensions,s=this;if(this.nodeCache[n]!==void 0)return this.nodeCache[n];const r=e.nodes[n],a=r.name?s.createUniqueName(r.name):"",u=[],c=s._invokeOne(function(d){return d.createNodeMesh&&d.createNodeMesh(n)});return c&&u.push(c),r.camera!==void 0&&u.push(s.getDependency("camera",r.camera).then(function(d){return s._getNodeRef(s.cameraCache,r.camera,d)})),s._invokeAll(function(d){return d.createNodeAttachment&&d.createNodeAttachment(n)}).forEach(function(d){u.push(d)}),this.nodeCache[n]=Promise.all(u).then(function(d){let _;if(r.isBone===!0?_=new Gn:d.length>1?_=new Ie:d.length===1?_=d[0]:_=new zt,_!==d[0])for(let t=0,o=d.length;t<o;t++)_.add(d[t]);if(r.name&&(_.userData.name=r.name,_.name=a),K(_,r),r.extensions&&Z(i,_,r),r.matrix!==void 0){const t=new xe;t.fromArray(r.matrix),_.applyMatrix4(t)}else r.translation!==void 0&&_.position.fromArray(r.translation),r.rotation!==void 0&&_.quaternion.fromArray(r.rotation),r.scale!==void 0&&_.scale.fromArray(r.scale);return s.associations.has(_)||s.associations.set(_,{}),s.associations.get(_).nodes=n,_}),this.nodeCache[n]}loadScene(n){const e=this.extensions,i=this.json.scenes[n],s=this,r=new Ie;i.name&&(r.name=s.createUniqueName(i.name)),K(r,i),i.extensions&&Z(e,r,i);const a=i.nodes||[],u=[];for(let c=0,d=a.length;c<d;c++)u.push(s.getDependency("node",a[c]));return Promise.all(u).then(function(c){for(let _=0,t=c.length;_<t;_++)r.add(c[_]);const d=_=>{const t=new Map;for(const[o,l]of s.associations)(o instanceof Pe||o instanceof At)&&t.set(o,l);return _.traverse(o=>{const l=s.associations.get(o);l!=null&&t.set(o,l)}),t};return s.associations=d(r),r})}_createAnimationTracks(n,e,i,s,r){const a=[],u=n.name?n.name:n.uuid,c=[];Y[r.path]===Y.weights?n.traverse(function(o){o.morphTargetInfluences&&c.push(o.name?o.name:o.uuid)}):c.push(u);let d;switch(Y[r.path]){case Y.weights:d=St;break;case Y.rotation:d=Mt;break;case Y.translation:case Y.scale:d=Et;break;default:switch(i.itemSize){case 1:d=St;break;case 2:case 3:default:d=Et;break}break}const _=s.interpolation!==void 0?Vs[s.interpolation]:Zt,t=this._getArrayFromAccessor(i);for(let o=0,l=c.length;o<l;o++){const h=new d(c[o]+"."+Y[r.path],e.array,t,_);s.interpolation==="CUBICSPLINE"&&this._createCubicSplineTrackInterpolant(h),a.push(h)}return a}_getArrayFromAccessor(n){let e=n.array;if(n.normalized){const i=Xe(e.constructor),s=new Float32Array(e.length);for(let r=0,a=e.length;r<a;r++)s[r]=e[r]*i;e=s}return e}_createCubicSplineTrackInterpolant(n){n.createInterpolant=function(i){const s=this instanceof Mt?zs:$t;return new s(this.times,this.values,this.getValueSize()/3,i)},n.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function $s(f,n,e){const i=n.attributes,s=new Yn;if(i.POSITION!==void 0){const u=e.json.accessors[i.POSITION],c=u.min,d=u.max;if(c!==void 0&&d!==void 0){if(s.set(new S(c[0],c[1],c[2]),new S(d[0],d[1],d[2])),u.normalized){const _=Xe(oe[u.componentType]);s.min.multiplyScalar(_),s.max.multiplyScalar(_)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const r=n.targets;if(r!==void 0){const u=new S,c=new S;for(let d=0,_=r.length;d<_;d++){const t=r[d];if(t.POSITION!==void 0){const o=e.json.accessors[t.POSITION],l=o.min,h=o.max;if(l!==void 0&&h!==void 0){if(c.setX(Math.max(Math.abs(l[0]),Math.abs(h[0]))),c.setY(Math.max(Math.abs(l[1]),Math.abs(h[1]))),c.setZ(Math.max(Math.abs(l[2]),Math.abs(h[2]))),o.normalized){const m=Xe(oe[o.componentType]);c.multiplyScalar(m)}u.max(c)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(u)}f.boundingBox=s;const a=new qn;s.getCenter(a.center),a.radius=s.min.distanceTo(s.max)/2,f.boundingSphere=a}function Ct(f,n,e){const i=n.attributes,s=[];function r(a,u){return e.getDependency("accessor",a).then(function(c){f.setAttribute(u,c)})}for(const a in i){const u=Ve[a]||a.toLowerCase();u in f.attributes||s.push(r(i[a],u))}if(n.indices!==void 0&&!f.index){const a=e.getDependency("accessor",n.indices).then(function(u){f.setIndex(u)});s.push(a)}return Ke.workingColorSpace!==U&&"COLOR_0"in i&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${Ke.workingColorSpace}" not supported.`),K(f,n),$s(f,n,e),Promise.all(s).then(function(){return n.targets!==void 0?Ys(f,n.targets,e):f})}var le=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},He={};/*!
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */var Nt;function eo(){return Nt||(Nt=1,function(f){(function(){var n=function(){this.init()};n.prototype={init:function(){var t=this||e;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator=typeof window<"u"&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(t){var o=this||e;if(t=parseFloat(t),o.ctx||_(),typeof t<"u"&&t>=0&&t<=1){if(o._volume=t,o._muted)return o;o.usingWebAudio&&o.masterGain.gain.setValueAtTime(t,e.ctx.currentTime);for(var l=0;l<o._howls.length;l++)if(!o._howls[l]._webAudio)for(var h=o._howls[l]._getSoundIds(),m=0;m<h.length;m++){var g=o._howls[l]._soundById(h[m]);g&&g._node&&(g._node.volume=g._volume*t)}return o}return o._volume},mute:function(t){var o=this||e;o.ctx||_(),o._muted=t,o.usingWebAudio&&o.masterGain.gain.setValueAtTime(t?0:o._volume,e.ctx.currentTime);for(var l=0;l<o._howls.length;l++)if(!o._howls[l]._webAudio)for(var h=o._howls[l]._getSoundIds(),m=0;m<h.length;m++){var g=o._howls[l]._soundById(h[m]);g&&g._node&&(g._node.muted=t?!0:g._muted)}return o},stop:function(){for(var t=this||e,o=0;o<t._howls.length;o++)t._howls[o].stop();return t},unload:function(){for(var t=this||e,o=t._howls.length-1;o>=0;o--)t._howls[o].unload();return t.usingWebAudio&&t.ctx&&typeof t.ctx.close<"u"&&(t.ctx.close(),t.ctx=null,_()),t},codecs:function(t){return(this||e)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||e;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if(typeof Audio<"u")try{var o=new Audio;typeof o.oncanplaythrough>"u"&&(t._canPlayEvent="canplay")}catch{t.noAudio=!0}else t.noAudio=!0;try{var o=new Audio;o.muted&&(t.noAudio=!0)}catch{}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||e,o=null;try{o=typeof Audio<"u"?new Audio:null}catch{return t}if(!o||typeof o.canPlayType!="function")return t;var l=o.canPlayType("audio/mpeg;").replace(/^no$/,""),h=t._navigator?t._navigator.userAgent:"",m=h.match(/OPR\/(\d+)/g),g=m&&parseInt(m[0].split("/")[1],10)<33,p=h.indexOf("Safari")!==-1&&h.indexOf("Chrome")===-1,y=h.match(/Version\/(.*?) /),T=p&&y&&parseInt(y[1],10)<15;return t._codecs={mp3:!!(!g&&(l||o.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!l,opus:!!o.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!o.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(o.canPlayType('audio/wav; codecs="1"')||o.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!o.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!o.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(o.canPlayType("audio/x-m4a;")||o.canPlayType("audio/m4a;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(o.canPlayType("audio/x-m4b;")||o.canPlayType("audio/m4b;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(o.canPlayType("audio/x-mp4;")||o.canPlayType("audio/mp4;")||o.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!T&&o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!T&&o.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!o.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(o.canPlayType("audio/x-flac;")||o.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_unlockAudio:function(){var t=this||e;if(!(t._audioUnlocked||!t.ctx)){t._audioUnlocked=!1,t.autoUnlock=!1,!t._mobileUnloaded&&t.ctx.sampleRate!==44100&&(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var o=function(l){for(;t._html5AudioPool.length<t.html5PoolSize;)try{var h=new Audio;h._unlocked=!0,t._releaseHtml5Audio(h)}catch{t.noAudio=!0;break}for(var m=0;m<t._howls.length;m++)if(!t._howls[m]._webAudio)for(var g=t._howls[m]._getSoundIds(),p=0;p<g.length;p++){var y=t._howls[m]._soundById(g[p]);y&&y._node&&!y._node._unlocked&&(y._node._unlocked=!0,y._node.load())}t._autoResume();var T=t.ctx.createBufferSource();T.buffer=t._scratchBuffer,T.connect(t.ctx.destination),typeof T.start>"u"?T.noteOn(0):T.start(0),typeof t.ctx.resume=="function"&&t.ctx.resume(),T.onended=function(){T.disconnect(0),t._audioUnlocked=!0,document.removeEventListener("touchstart",o,!0),document.removeEventListener("touchend",o,!0),document.removeEventListener("click",o,!0),document.removeEventListener("keydown",o,!0);for(var b=0;b<t._howls.length;b++)t._howls[b]._emit("unlock")}};return document.addEventListener("touchstart",o,!0),document.addEventListener("touchend",o,!0),document.addEventListener("click",o,!0),document.addEventListener("keydown",o,!0),t}},_obtainHtml5Audio:function(){var t=this||e;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var o=new Audio().play();return o&&typeof Promise<"u"&&(o instanceof Promise||typeof o.then=="function")&&o.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(t){var o=this||e;return t._unlocked&&o._html5AudioPool.push(t),o},_autoSuspend:function(){var t=this;if(!(!t.autoSuspend||!t.ctx||typeof t.ctx.suspend>"u"||!e.usingWebAudio)){for(var o=0;o<t._howls.length;o++)if(t._howls[o]._webAudio){for(var l=0;l<t._howls[o]._sounds.length;l++)if(!t._howls[o]._sounds[l]._paused)return t}return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout(function(){if(t.autoSuspend){t._suspendTimer=null,t.state="suspending";var h=function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())};t.ctx.suspend().then(h,h)}},3e4),t}},_autoResume:function(){var t=this;if(!(!t.ctx||typeof t.ctx.resume>"u"||!e.usingWebAudio))return t.state==="running"&&t.ctx.state!=="interrupted"&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):t.state==="suspended"||t.state==="running"&&t.ctx.state==="interrupted"?(t.ctx.resume().then(function(){t.state="running";for(var o=0;o<t._howls.length;o++)t._howls[o]._emit("resume")}),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):t.state==="suspending"&&(t._resumeAfterSuspend=!0),t}};var e=new n,i=function(t){var o=this;if(!t.src||t.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}o.init(t)};i.prototype={init:function(t){var o=this;return e.ctx||_(),o._autoplay=t.autoplay||!1,o._format=typeof t.format!="string"?t.format:[t.format],o._html5=t.html5||!1,o._muted=t.mute||!1,o._loop=t.loop||!1,o._pool=t.pool||5,o._preload=typeof t.preload=="boolean"||t.preload==="metadata"?t.preload:!0,o._rate=t.rate||1,o._sprite=t.sprite||{},o._src=typeof t.src!="string"?t.src:[t.src],o._volume=t.volume!==void 0?t.volume:1,o._xhr={method:t.xhr&&t.xhr.method?t.xhr.method:"GET",headers:t.xhr&&t.xhr.headers?t.xhr.headers:null,withCredentials:t.xhr&&t.xhr.withCredentials?t.xhr.withCredentials:!1},o._duration=0,o._state="unloaded",o._sounds=[],o._endTimers={},o._queue=[],o._playLock=!1,o._onend=t.onend?[{fn:t.onend}]:[],o._onfade=t.onfade?[{fn:t.onfade}]:[],o._onload=t.onload?[{fn:t.onload}]:[],o._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],o._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],o._onpause=t.onpause?[{fn:t.onpause}]:[],o._onplay=t.onplay?[{fn:t.onplay}]:[],o._onstop=t.onstop?[{fn:t.onstop}]:[],o._onmute=t.onmute?[{fn:t.onmute}]:[],o._onvolume=t.onvolume?[{fn:t.onvolume}]:[],o._onrate=t.onrate?[{fn:t.onrate}]:[],o._onseek=t.onseek?[{fn:t.onseek}]:[],o._onunlock=t.onunlock?[{fn:t.onunlock}]:[],o._onresume=[],o._webAudio=e.usingWebAudio&&!o._html5,typeof e.ctx<"u"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(o),o._autoplay&&o._queue.push({event:"play",action:function(){o.play()}}),o._preload&&o._preload!=="none"&&o.load(),o},load:function(){var t=this,o=null;if(e.noAudio){t._emit("loaderror",null,"No audio support.");return}typeof t._src=="string"&&(t._src=[t._src]);for(var l=0;l<t._src.length;l++){var h,m;if(t._format&&t._format[l])h=t._format[l];else{if(m=t._src[l],typeof m!="string"){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}h=/^data:audio\/([^;,]+);/i.exec(m),h||(h=/\.([^.]+)$/.exec(m.split("?",1)[0])),h&&(h=h[1].toLowerCase())}if(h||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),h&&e.codecs(h)){o=t._src[l];break}}if(!o){t._emit("loaderror",null,"No codec support for selected audio sources.");return}return t._src=o,t._state="loading",window.location.protocol==="https:"&&o.slice(0,5)==="http:"&&(t._html5=!0,t._webAudio=!1),new s(t),t._webAudio&&a(t),t},play:function(t,o){var l=this,h=null;if(typeof t=="number")h=t,t=null;else{if(typeof t=="string"&&l._state==="loaded"&&!l._sprite[t])return null;if(typeof t>"u"&&(t="__default",!l._playLock)){for(var m=0,g=0;g<l._sounds.length;g++)l._sounds[g]._paused&&!l._sounds[g]._ended&&(m++,h=l._sounds[g]._id);m===1?t=null:h=null}}var p=h?l._soundById(h):l._inactiveSound();if(!p)return null;if(h&&!t&&(t=p._sprite||"__default"),l._state!=="loaded"){p._sprite=t,p._ended=!1;var y=p._id;return l._queue.push({event:"play",action:function(){l.play(y)}}),y}if(h&&!p._paused)return o||l._loadQueue("play"),p._id;l._webAudio&&e._autoResume();var T=Math.max(0,p._seek>0?p._seek:l._sprite[t][0]/1e3),b=Math.max(0,(l._sprite[t][0]+l._sprite[t][1])/1e3-T),A=b*1e3/Math.abs(p._rate),L=l._sprite[t][0]/1e3,M=(l._sprite[t][0]+l._sprite[t][1])/1e3;p._sprite=t,p._ended=!1;var j=function(){p._paused=!1,p._seek=T,p._start=L,p._stop=M,p._loop=!!(p._loop||l._sprite[t][2])};if(T>=M){l._ended(p);return}var w=p._node;if(l._webAudio){var $=function(){l._playLock=!1,j(),l._refreshBuffer(p);var ee=p._muted||l._muted?0:p._volume;w.gain.setValueAtTime(ee,e.ctx.currentTime),p._playStart=e.ctx.currentTime,typeof w.bufferSource.start>"u"?p._loop?w.bufferSource.noteGrainOn(0,T,86400):w.bufferSource.noteGrainOn(0,T,b):p._loop?w.bufferSource.start(0,T,86400):w.bufferSource.start(0,T,b),A!==1/0&&(l._endTimers[p._id]=setTimeout(l._ended.bind(l,p),A)),o||setTimeout(function(){l._emit("play",p._id),l._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?$():(l._playLock=!0,l.once("resume",$),l._clearTimer(p._id))}else{var vt=function(){w.currentTime=T,w.muted=p._muted||l._muted||e._muted||w.muted,w.volume=p._volume*e.volume(),w.playbackRate=p._rate;try{var ee=w.play();if(ee&&typeof Promise<"u"&&(ee instanceof Promise||typeof ee.then=="function")?(l._playLock=!0,j(),ee.then(function(){l._playLock=!1,w._unlocked=!0,o?l._loadQueue():l._emit("play",p._id)}).catch(function(){l._playLock=!1,l._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),p._ended=!0,p._paused=!0})):o||(l._playLock=!1,j(),l._emit("play",p._id)),w.playbackRate=p._rate,w.paused){l._emit("playerror",p._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}t!=="__default"||p._loop?l._endTimers[p._id]=setTimeout(l._ended.bind(l,p),A):(l._endTimers[p._id]=function(){l._ended(p),w.removeEventListener("ended",l._endTimers[p._id],!1)},w.addEventListener("ended",l._endTimers[p._id],!1))}catch(pn){l._emit("playerror",p._id,pn)}};w.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(w.src=l._src,w.load());var hn=window&&window.ejecta||!w.readyState&&e._navigator.isCocoonJS;if(w.readyState>=3||hn)vt();else{l._playLock=!0,l._state="loading";var wt=function(){l._state="loaded",vt(),w.removeEventListener(e._canPlayEvent,wt,!1)};w.addEventListener(e._canPlayEvent,wt,!1),l._clearTimer(p._id)}}return p._id},pause:function(t){var o=this;if(o._state!=="loaded"||o._playLock)return o._queue.push({event:"pause",action:function(){o.pause(t)}}),o;for(var l=o._getSoundIds(t),h=0;h<l.length;h++){o._clearTimer(l[h]);var m=o._soundById(l[h]);if(m&&!m._paused&&(m._seek=o.seek(l[h]),m._rateSeek=0,m._paused=!0,o._stopFade(l[h]),m._node))if(o._webAudio){if(!m._node.bufferSource)continue;typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),o._cleanBuffer(m._node)}else(!isNaN(m._node.duration)||m._node.duration===1/0)&&m._node.pause();arguments[1]||o._emit("pause",m?m._id:null)}return o},stop:function(t,o){var l=this;if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"stop",action:function(){l.stop(t)}}),l;for(var h=l._getSoundIds(t),m=0;m<h.length;m++){l._clearTimer(h[m]);var g=l._soundById(h[m]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,l._stopFade(h[m]),g._node&&(l._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),l._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&l._clearSound(g._node))),o||l._emit("stop",g._id))}return l},mute:function(t,o){var l=this;if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"mute",action:function(){l.mute(t,o)}}),l;if(typeof o>"u")if(typeof t=="boolean")l._muted=t;else return l._muted;for(var h=l._getSoundIds(o),m=0;m<h.length;m++){var g=l._soundById(h[m]);g&&(g._muted=t,g._interval&&l._stopFade(g._id),l._webAudio&&g._node?g._node.gain.setValueAtTime(t?0:g._volume,e.ctx.currentTime):g._node&&(g._node.muted=e._muted?!0:t),l._emit("mute",g._id))}return l},volume:function(){var t=this,o=arguments,l,h;if(o.length===0)return t._volume;if(o.length===1||o.length===2&&typeof o[1]>"u"){var m=t._getSoundIds(),g=m.indexOf(o[0]);g>=0?h=parseInt(o[0],10):l=parseFloat(o[0])}else o.length>=2&&(l=parseFloat(o[0]),h=parseInt(o[1],10));var p;if(typeof l<"u"&&l>=0&&l<=1){if(t._state!=="loaded"||t._playLock)return t._queue.push({event:"volume",action:function(){t.volume.apply(t,o)}}),t;typeof h>"u"&&(t._volume=l),h=t._getSoundIds(h);for(var y=0;y<h.length;y++)p=t._soundById(h[y]),p&&(p._volume=l,o[2]||t._stopFade(h[y]),t._webAudio&&p._node&&!p._muted?p._node.gain.setValueAtTime(l,e.ctx.currentTime):p._node&&!p._muted&&(p._node.volume=l*e.volume()),t._emit("volume",p._id))}else return p=h?t._soundById(h):t._sounds[0],p?p._volume:0;return t},fade:function(t,o,l,h){var m=this;if(m._state!=="loaded"||m._playLock)return m._queue.push({event:"fade",action:function(){m.fade(t,o,l,h)}}),m;t=Math.min(Math.max(0,parseFloat(t)),1),o=Math.min(Math.max(0,parseFloat(o)),1),l=parseFloat(l),m.volume(t,h);for(var g=m._getSoundIds(h),p=0;p<g.length;p++){var y=m._soundById(g[p]);if(y){if(h||m._stopFade(g[p]),m._webAudio&&!y._muted){var T=e.ctx.currentTime,b=T+l/1e3;y._volume=t,y._node.gain.setValueAtTime(t,T),y._node.gain.linearRampToValueAtTime(o,b)}m._startFadeInterval(y,t,o,l,g[p],typeof h>"u")}}return m},_startFadeInterval:function(t,o,l,h,m,g){var p=this,y=o,T=l-o,b=Math.abs(T/.01),A=Math.max(4,b>0?h/b:h),L=Date.now();t._fadeTo=l,t._interval=setInterval(function(){var M=(Date.now()-L)/h;L=Date.now(),y+=T*M,y=Math.round(y*100)/100,T<0?y=Math.max(l,y):y=Math.min(l,y),p._webAudio?t._volume=y:p.volume(y,t._id,!0),g&&(p._volume=y),(l<o&&y<=l||l>o&&y>=l)&&(clearInterval(t._interval),t._interval=null,t._fadeTo=null,p.volume(l,t._id),p._emit("fade",t._id))},A)},_stopFade:function(t){var o=this,l=o._soundById(t);return l&&l._interval&&(o._webAudio&&l._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(l._interval),l._interval=null,o.volume(l._fadeTo,t),l._fadeTo=null,o._emit("fade",t)),o},loop:function(){var t=this,o=arguments,l,h,m;if(o.length===0)return t._loop;if(o.length===1)if(typeof o[0]=="boolean")l=o[0],t._loop=l;else return m=t._soundById(parseInt(o[0],10)),m?m._loop:!1;else o.length===2&&(l=o[0],h=parseInt(o[1],10));for(var g=t._getSoundIds(h),p=0;p<g.length;p++)m=t._soundById(g[p]),m&&(m._loop=l,t._webAudio&&m._node&&m._node.bufferSource&&(m._node.bufferSource.loop=l,l&&(m._node.bufferSource.loopStart=m._start||0,m._node.bufferSource.loopEnd=m._stop,t.playing(g[p])&&(t.pause(g[p],!0),t.play(g[p],!0)))));return t},rate:function(){var t=this,o=arguments,l,h;if(o.length===0)h=t._sounds[0]._id;else if(o.length===1){var m=t._getSoundIds(),g=m.indexOf(o[0]);g>=0?h=parseInt(o[0],10):l=parseFloat(o[0])}else o.length===2&&(l=parseFloat(o[0]),h=parseInt(o[1],10));var p;if(typeof l=="number"){if(t._state!=="loaded"||t._playLock)return t._queue.push({event:"rate",action:function(){t.rate.apply(t,o)}}),t;typeof h>"u"&&(t._rate=l),h=t._getSoundIds(h);for(var y=0;y<h.length;y++)if(p=t._soundById(h[y]),p){t.playing(h[y])&&(p._rateSeek=t.seek(h[y]),p._playStart=t._webAudio?e.ctx.currentTime:p._playStart),p._rate=l,t._webAudio&&p._node&&p._node.bufferSource?p._node.bufferSource.playbackRate.setValueAtTime(l,e.ctx.currentTime):p._node&&(p._node.playbackRate=l);var T=t.seek(h[y]),b=(t._sprite[p._sprite][0]+t._sprite[p._sprite][1])/1e3-T,A=b*1e3/Math.abs(p._rate);(t._endTimers[h[y]]||!p._paused)&&(t._clearTimer(h[y]),t._endTimers[h[y]]=setTimeout(t._ended.bind(t,p),A)),t._emit("rate",p._id)}}else return p=t._soundById(h),p?p._rate:t._rate;return t},seek:function(){var t=this,o=arguments,l,h;if(o.length===0)t._sounds.length&&(h=t._sounds[0]._id);else if(o.length===1){var m=t._getSoundIds(),g=m.indexOf(o[0]);g>=0?h=parseInt(o[0],10):t._sounds.length&&(h=t._sounds[0]._id,l=parseFloat(o[0]))}else o.length===2&&(l=parseFloat(o[0]),h=parseInt(o[1],10));if(typeof h>"u")return 0;if(typeof l=="number"&&(t._state!=="loaded"||t._playLock))return t._queue.push({event:"seek",action:function(){t.seek.apply(t,o)}}),t;var p=t._soundById(h);if(p)if(typeof l=="number"&&l>=0){var y=t.playing(h);y&&t.pause(h,!0),p._seek=l,p._ended=!1,t._clearTimer(h),!t._webAudio&&p._node&&!isNaN(p._node.duration)&&(p._node.currentTime=l);var T=function(){y&&t.play(h,!0),t._emit("seek",h)};if(y&&!t._webAudio){var b=function(){t._playLock?setTimeout(b,0):T()};setTimeout(b,0)}else T()}else if(t._webAudio){var A=t.playing(h)?e.ctx.currentTime-p._playStart:0,L=p._rateSeek?p._rateSeek-p._seek:0;return p._seek+(L+A*Math.abs(p._rate))}else return p._node.currentTime;return t},playing:function(t){var o=this;if(typeof t=="number"){var l=o._soundById(t);return l?!l._paused:!1}for(var h=0;h<o._sounds.length;h++)if(!o._sounds[h]._paused)return!0;return!1},duration:function(t){var o=this,l=o._duration,h=o._soundById(t);return h&&(l=o._sprite[h._sprite][1]/1e3),l},state:function(){return this._state},unload:function(){for(var t=this,o=t._sounds,l=0;l<o.length;l++)o[l]._paused||t.stop(o[l]._id),t._webAudio||(t._clearSound(o[l]._node),o[l]._node.removeEventListener("error",o[l]._errorFn,!1),o[l]._node.removeEventListener(e._canPlayEvent,o[l]._loadFn,!1),o[l]._node.removeEventListener("ended",o[l]._endFn,!1),e._releaseHtml5Audio(o[l]._node)),delete o[l]._node,t._clearTimer(o[l]._id);var h=e._howls.indexOf(t);h>=0&&e._howls.splice(h,1);var m=!0;for(l=0;l<e._howls.length;l++)if(e._howls[l]._src===t._src||t._src.indexOf(e._howls[l]._src)>=0){m=!1;break}return r&&m&&delete r[t._src],e.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(t,o,l,h){var m=this,g=m["_on"+t];return typeof o=="function"&&g.push(h?{id:l,fn:o,once:h}:{id:l,fn:o}),m},off:function(t,o,l){var h=this,m=h["_on"+t],g=0;if(typeof o=="number"&&(l=o,o=null),o||l)for(g=0;g<m.length;g++){var p=l===m[g].id;if(o===m[g].fn&&p||!o&&p){m.splice(g,1);break}}else if(t)h["_on"+t]=[];else{var y=Object.keys(h);for(g=0;g<y.length;g++)y[g].indexOf("_on")===0&&Array.isArray(h[y[g]])&&(h[y[g]]=[])}return h},once:function(t,o,l){var h=this;return h.on(t,o,l,1),h},_emit:function(t,o,l){for(var h=this,m=h["_on"+t],g=m.length-1;g>=0;g--)(!m[g].id||m[g].id===o||t==="load")&&(setTimeout((function(p){p.call(this,o,l)}).bind(h,m[g].fn),0),m[g].once&&h.off(t,m[g].fn,m[g].id));return h._loadQueue(t),h},_loadQueue:function(t){var o=this;if(o._queue.length>0){var l=o._queue[0];l.event===t&&(o._queue.shift(),o._loadQueue()),t||l.action()}return o},_ended:function(t){var o=this,l=t._sprite;if(!o._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(o._ended.bind(o,t),100),o;var h=!!(t._loop||o._sprite[l][2]);if(o._emit("end",t._id),!o._webAudio&&h&&o.stop(t._id,!0).play(t._id),o._webAudio&&h){o._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=e.ctx.currentTime;var m=(t._stop-t._start)*1e3/Math.abs(t._rate);o._endTimers[t._id]=setTimeout(o._ended.bind(o,t),m)}return o._webAudio&&!h&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,o._clearTimer(t._id),o._cleanBuffer(t._node),e._autoSuspend()),!o._webAudio&&!h&&o.stop(t._id,!0),o},_clearTimer:function(t){var o=this;if(o._endTimers[t]){if(typeof o._endTimers[t]!="function")clearTimeout(o._endTimers[t]);else{var l=o._soundById(t);l&&l._node&&l._node.removeEventListener("ended",o._endTimers[t],!1)}delete o._endTimers[t]}return o},_soundById:function(t){for(var o=this,l=0;l<o._sounds.length;l++)if(t===o._sounds[l]._id)return o._sounds[l];return null},_inactiveSound:function(){var t=this;t._drain();for(var o=0;o<t._sounds.length;o++)if(t._sounds[o]._ended)return t._sounds[o].reset();return new s(t)},_drain:function(){var t=this,o=t._pool,l=0,h=0;if(!(t._sounds.length<o)){for(h=0;h<t._sounds.length;h++)t._sounds[h]._ended&&l++;for(h=t._sounds.length-1;h>=0;h--){if(l<=o)return;t._sounds[h]._ended&&(t._webAudio&&t._sounds[h]._node&&t._sounds[h]._node.disconnect(0),t._sounds.splice(h,1),l--)}}},_getSoundIds:function(t){var o=this;if(typeof t>"u"){for(var l=[],h=0;h<o._sounds.length;h++)l.push(o._sounds[h]._id);return l}else return[t]},_refreshBuffer:function(t){var o=this;return t._node.bufferSource=e.ctx.createBufferSource(),t._node.bufferSource.buffer=r[o._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,e.ctx.currentTime),o},_cleanBuffer:function(t){var o=this,l=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(!t.bufferSource)return o;if(e._scratchBuffer&&t.bufferSource&&(t.bufferSource.onended=null,t.bufferSource.disconnect(0),l))try{t.bufferSource.buffer=e._scratchBuffer}catch{}return t.bufferSource=null,o},_clearSound:function(t){var o=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);o||(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var s=function(t){this._parent=t,this.init()};s.prototype={init:function(){var t=this,o=t._parent;return t._muted=o._muted,t._loop=o._loop,t._volume=o._volume,t._rate=o._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++e._counter,o._sounds.push(t),t.create(),t},create:function(){var t=this,o=t._parent,l=e._muted||t._muted||t._parent._muted?0:t._volume;return o._webAudio?(t._node=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),t._node.gain.setValueAtTime(l,e.ctx.currentTime),t._node.paused=!0,t._node.connect(e.masterGain)):e.noAudio||(t._node=e._obtainHtml5Audio(),t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(e._canPlayEvent,t._loadFn,!1),t._endFn=t._endListener.bind(t),t._node.addEventListener("ended",t._endFn,!1),t._node.src=o._src,t._node.preload=o._preload===!0?"auto":o._preload,t._node.volume=l*e.volume(),t._node.load()),t},reset:function(){var t=this,o=t._parent;return t._muted=o._muted,t._loop=o._loop,t._volume=o._volume,t._rate=o._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++e._counter,t},_errorListener:function(){var t=this;t._parent._emit("loaderror",t._id,t._node.error?t._node.error.code:0),t._node.removeEventListener("error",t._errorFn,!1)},_loadListener:function(){var t=this,o=t._parent;o._duration=Math.ceil(t._node.duration*10)/10,Object.keys(o._sprite).length===0&&(o._sprite={__default:[0,o._duration*1e3]}),o._state!=="loaded"&&(o._state="loaded",o._emit("load"),o._loadQueue()),t._node.removeEventListener(e._canPlayEvent,t._loadFn,!1)},_endListener:function(){var t=this,o=t._parent;o._duration===1/0&&(o._duration=Math.ceil(t._node.duration*10)/10,o._sprite.__default[1]===1/0&&(o._sprite.__default[1]=o._duration*1e3),o._ended(t)),t._node.removeEventListener("ended",t._endFn,!1)}};var r={},a=function(t){var o=t._src;if(r[o]){t._duration=r[o].duration,d(t);return}if(/^data:[^;]+;base64,/.test(o)){for(var l=atob(o.split(",")[1]),h=new Uint8Array(l.length),m=0;m<l.length;++m)h[m]=l.charCodeAt(m);c(h.buffer,t)}else{var g=new XMLHttpRequest;g.open(t._xhr.method,o,!0),g.withCredentials=t._xhr.withCredentials,g.responseType="arraybuffer",t._xhr.headers&&Object.keys(t._xhr.headers).forEach(function(p){g.setRequestHeader(p,t._xhr.headers[p])}),g.onload=function(){var p=(g.status+"")[0];if(p!=="0"&&p!=="2"&&p!=="3"){t._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}c(g.response,t)},g.onerror=function(){t._webAudio&&(t._html5=!0,t._webAudio=!1,t._sounds=[],delete r[o],t.load())},u(g)}},u=function(t){try{t.send()}catch{t.onerror()}},c=function(t,o){var l=function(){o._emit("loaderror",null,"Decoding audio data failed.")},h=function(m){m&&o._sounds.length>0?(r[o._src]=m,d(o,m)):l()};typeof Promise<"u"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(t).then(h).catch(l):e.ctx.decodeAudioData(t,h,l)},d=function(t,o){o&&!t._duration&&(t._duration=o.duration),Object.keys(t._sprite).length===0&&(t._sprite={__default:[0,t._duration*1e3]}),t._state!=="loaded"&&(t._state="loaded",t._emit("load"),t._loadQueue())},_=function(){if(e.usingWebAudio){try{typeof AudioContext<"u"?e.ctx=new AudioContext:typeof webkitAudioContext<"u"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var t=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),o=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),l=o?parseInt(o[1],10):null;if(t&&l&&l<9){var h=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!h&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};f.Howler=e,f.Howl=i,typeof le<"u"?(le.HowlerGlobal=n,le.Howler=e,le.Howl=i,le.Sound=s):typeof window<"u"&&(window.HowlerGlobal=n,window.Howler=e,window.Howl=i,window.Sound=s)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var i=this;if(!i.ctx||!i.ctx.listener)return i;for(var s=i._howls.length-1;s>=0;s--)i._howls[s].stereo(e);return i},HowlerGlobal.prototype.pos=function(e,i,s){var r=this;if(!r.ctx||!r.ctx.listener)return r;if(i=typeof i!="number"?r._pos[1]:i,s=typeof s!="number"?r._pos[2]:s,typeof e=="number")r._pos=[e,i,s],typeof r.ctx.listener.positionX<"u"?(r.ctx.listener.positionX.setTargetAtTime(r._pos[0],Howler.ctx.currentTime,.1),r.ctx.listener.positionY.setTargetAtTime(r._pos[1],Howler.ctx.currentTime,.1),r.ctx.listener.positionZ.setTargetAtTime(r._pos[2],Howler.ctx.currentTime,.1)):r.ctx.listener.setPosition(r._pos[0],r._pos[1],r._pos[2]);else return r._pos;return r},HowlerGlobal.prototype.orientation=function(e,i,s,r,a,u){var c=this;if(!c.ctx||!c.ctx.listener)return c;var d=c._orientation;if(i=typeof i!="number"?d[1]:i,s=typeof s!="number"?d[2]:s,r=typeof r!="number"?d[3]:r,a=typeof a!="number"?d[4]:a,u=typeof u!="number"?d[5]:u,typeof e=="number")c._orientation=[e,i,s,r,a,u],typeof c.ctx.listener.forwardX<"u"?(c.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),c.ctx.listener.forwardY.setTargetAtTime(i,Howler.ctx.currentTime,.1),c.ctx.listener.forwardZ.setTargetAtTime(s,Howler.ctx.currentTime,.1),c.ctx.listener.upX.setTargetAtTime(r,Howler.ctx.currentTime,.1),c.ctx.listener.upY.setTargetAtTime(a,Howler.ctx.currentTime,.1),c.ctx.listener.upZ.setTargetAtTime(u,Howler.ctx.currentTime,.1)):c.ctx.listener.setOrientation(e,i,s,r,a,u);else return d;return c},Howl.prototype.init=function(e){return function(i){var s=this;return s._orientation=i.orientation||[1,0,0],s._stereo=i.stereo||null,s._pos=i.pos||null,s._pannerAttr={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:360,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:360,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:0,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:"inverse",maxDistance:typeof i.maxDistance<"u"?i.maxDistance:1e4,panningModel:typeof i.panningModel<"u"?i.panningModel:"HRTF",refDistance:typeof i.refDistance<"u"?i.refDistance:1,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:1},s._onstereo=i.onstereo?[{fn:i.onstereo}]:[],s._onpos=i.onpos?[{fn:i.onpos}]:[],s._onorientation=i.onorientation?[{fn:i.onorientation}]:[],e.call(this,i)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,i){var s=this;if(!s._webAudio)return s;if(s._state!=="loaded")return s._queue.push({event:"stereo",action:function(){s.stereo(e,i)}}),s;var r=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof i>"u")if(typeof e=="number")s._stereo=e,s._pos=[e,0,0];else return s._stereo;for(var a=s._getSoundIds(i),u=0;u<a.length;u++){var c=s._soundById(a[u]);if(c)if(typeof e=="number")c._stereo=e,c._pos=[e,0,0],c._node&&(c._pannerAttr.panningModel="equalpower",(!c._panner||!c._panner.pan)&&n(c,r),r==="spatial"?typeof c._panner.positionX<"u"?(c._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),c._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),c._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):c._panner.setPosition(e,0,0):c._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),s._emit("stereo",c._id);else return c._stereo}return s},Howl.prototype.pos=function(e,i,s,r){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"pos",action:function(){a.pos(e,i,s,r)}}),a;if(i=typeof i!="number"?0:i,s=typeof s!="number"?-.5:s,typeof r>"u")if(typeof e=="number")a._pos=[e,i,s];else return a._pos;for(var u=a._getSoundIds(r),c=0;c<u.length;c++){var d=a._soundById(u[c]);if(d)if(typeof e=="number")d._pos=[e,i,s],d._node&&((!d._panner||d._panner.pan)&&n(d,"spatial"),typeof d._panner.positionX<"u"?(d._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),d._panner.positionY.setValueAtTime(i,Howler.ctx.currentTime),d._panner.positionZ.setValueAtTime(s,Howler.ctx.currentTime)):d._panner.setPosition(e,i,s)),a._emit("pos",d._id);else return d._pos}return a},Howl.prototype.orientation=function(e,i,s,r){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"orientation",action:function(){a.orientation(e,i,s,r)}}),a;if(i=typeof i!="number"?a._orientation[1]:i,s=typeof s!="number"?a._orientation[2]:s,typeof r>"u")if(typeof e=="number")a._orientation=[e,i,s];else return a._orientation;for(var u=a._getSoundIds(r),c=0;c<u.length;c++){var d=a._soundById(u[c]);if(d)if(typeof e=="number")d._orientation=[e,i,s],d._node&&(d._panner||(d._pos||(d._pos=a._pos||[0,0,-.5]),n(d,"spatial")),typeof d._panner.orientationX<"u"?(d._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),d._panner.orientationY.setValueAtTime(i,Howler.ctx.currentTime),d._panner.orientationZ.setValueAtTime(s,Howler.ctx.currentTime)):d._panner.setOrientation(e,i,s)),a._emit("orientation",d._id);else return d._orientation}return a},Howl.prototype.pannerAttr=function(){var e=this,i=arguments,s,r,a;if(!e._webAudio)return e;if(i.length===0)return e._pannerAttr;if(i.length===1)if(typeof i[0]=="object")s=i[0],typeof r>"u"&&(s.pannerAttr||(s.pannerAttr={coneInnerAngle:s.coneInnerAngle,coneOuterAngle:s.coneOuterAngle,coneOuterGain:s.coneOuterGain,distanceModel:s.distanceModel,maxDistance:s.maxDistance,refDistance:s.refDistance,rolloffFactor:s.rolloffFactor,panningModel:s.panningModel}),e._pannerAttr={coneInnerAngle:typeof s.pannerAttr.coneInnerAngle<"u"?s.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof s.pannerAttr.coneOuterAngle<"u"?s.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof s.pannerAttr.coneOuterGain<"u"?s.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof s.pannerAttr.distanceModel<"u"?s.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof s.pannerAttr.maxDistance<"u"?s.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof s.pannerAttr.refDistance<"u"?s.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof s.pannerAttr.rolloffFactor<"u"?s.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof s.pannerAttr.panningModel<"u"?s.pannerAttr.panningModel:e._panningModel});else return a=e._soundById(parseInt(i[0],10)),a?a._pannerAttr:e._pannerAttr;else i.length===2&&(s=i[0],r=parseInt(i[1],10));for(var u=e._getSoundIds(r),c=0;c<u.length;c++)if(a=e._soundById(u[c]),a){var d=a._pannerAttr;d={coneInnerAngle:typeof s.coneInnerAngle<"u"?s.coneInnerAngle:d.coneInnerAngle,coneOuterAngle:typeof s.coneOuterAngle<"u"?s.coneOuterAngle:d.coneOuterAngle,coneOuterGain:typeof s.coneOuterGain<"u"?s.coneOuterGain:d.coneOuterGain,distanceModel:typeof s.distanceModel<"u"?s.distanceModel:d.distanceModel,maxDistance:typeof s.maxDistance<"u"?s.maxDistance:d.maxDistance,refDistance:typeof s.refDistance<"u"?s.refDistance:d.refDistance,rolloffFactor:typeof s.rolloffFactor<"u"?s.rolloffFactor:d.rolloffFactor,panningModel:typeof s.panningModel<"u"?s.panningModel:d.panningModel};var _=a._panner;_||(a._pos||(a._pos=e._pos||[0,0,-.5]),n(a,"spatial"),_=a._panner),_.coneInnerAngle=d.coneInnerAngle,_.coneOuterAngle=d.coneOuterAngle,_.coneOuterGain=d.coneOuterGain,_.distanceModel=d.distanceModel,_.maxDistance=d.maxDistance,_.refDistance=d.refDistance,_.rolloffFactor=d.rolloffFactor,_.panningModel=d.panningModel}return e},Sound.prototype.init=function(e){return function(){var i=this,s=i._parent;i._orientation=s._orientation,i._stereo=s._stereo,i._pos=s._pos,i._pannerAttr=s._pannerAttr,e.call(this),i._stereo?s.stereo(i._stereo):i._pos&&s.pos(i._pos[0],i._pos[1],i._pos[2],i._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var i=this,s=i._parent;return i._orientation=s._orientation,i._stereo=s._stereo,i._pos=s._pos,i._pannerAttr=s._pannerAttr,i._stereo?s.stereo(i._stereo):i._pos?s.pos(i._pos[0],i._pos[1],i._pos[2],i._id):i._panner&&(i._panner.disconnect(0),i._panner=void 0,s._refreshBuffer(i)),e.call(this)}}(Sound.prototype.reset);var n=function(e,i){i=i||"spatial",i==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX<"u"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX<"u"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()}(He)),He}var Me=eo();const to=document.querySelector("#experience-canvas"),P={width:window.innerWidth,height:window.innerHeight},en=[],tn=[],nn=[];let Ye=null,qe=null,We=null,Ze=null,Je=null,Qe=null,$e=null,et=null,tt=null,nt=null,st=null,ot=null,it=null,rt=null,at=!1,me=0,ge=0,mt=!1;const ie=[];let H=[],G=null;const Ft=new es,he=new D,W=new Wn;let k=0,ce=1,C=null,J=null,Ue=!0;const Be=new S(0,0,-.5),ye={work:document.querySelector(".modal.work"),about:document.querySelector(".modal.about"),contact:document.querySelector(".modal.contact"),legal:document.querySelector(".modal.legal")},sn=document.getElementById("loading-text"),no=document.getElementById("progress-bar"),lt=document.getElementById("enter-button"),je=document.getElementById("loading-screen"),Le=new Zn;Le.onProgress=(f,n,e)=>{const i=Math.floor(n/e*100);no.value=i,sn.textContent=`Loading ${n} of ${e}...`};Le.onLoad=()=>{sn.textContent="Loaded!",lt.disabled=!1,lt.classList.add("active")};lt.addEventListener("click",()=>{Ee.play(),Ee.volume=.5,F=!0,ut.src="/icon/music_note_124dp_3B3935_FILL0_wght700_GRAD-25_opsz48.svg",je.classList.add("hide"),je.addEventListener("transitionend",()=>{at=!0,je.remove(),ro()})});document.addEventListener("DOMContentLoaded",function(){const f=document.getElementById("tip-text");"ontouchstart"in window||navigator.maxTouchPoints>0?f.textContent="💡 Tip: Tap and swipe to explore.":f.textContent="💡 Tip: Click and drag to explore."});const ct={};for(let f=1;f<=9;f++)ct[`DJ${f}`]=new Me.Howl({src:[`/audio/DJ/DJ${f}.ogg`],volume:.7,preload:!0});const Ge=new Me.Howl({src:["/audio/sound/403007__inspectorj__ui-confirmation-alert-a2.ogg"],volume:.7}),Ht=new Me.Howl({src:["/audio/sound/71853__ludvique__record_scratch.ogg"],volume:.7}),Ee=new Me.Howl({src:["public/audio/frankum__vintage-elecro-pop-loop.ogg"],loop:!0,volume:.5}),ut=document.getElementById("music-icon"),gt=document.getElementById("music-toggle");let F=!1;gt.addEventListener("click",()=>{F=!F,F?(Ee.play(),ut.src="/icon/music_note_124dp_3B3935_FILL0_wght700_GRAD-25_opsz48.svg",Howler.mute(!1)):(Ee.pause(),ut.src="/icon/music_off_124dp_3B3935_FILL0_wght700_GRAD-25_opsz48.svg",Howler.mute(!0))});const on=document.getElementById("experience"),Te=f=>{f.classList.remove("hidden"),mt=!0,I.enabled=!1,on.classList.add("blur"),gt.classList.add("hidden"),ie.forEach(n=>{n.userData&&n.userData.hoverTimeline&&(n.userData.hoverDisabled=!0)}),document.body.style.cursor="default",H=[],N.set(f,{opacity:0}),N.to(f,{opacity:1,duration:.5})},Ut=f=>{mt=!1,I.enabled=!0,on.classList.remove("blur"),gt.classList.remove("hidden"),ie.forEach(n=>{n.userData&&n.userData.hoverTimeline&&(n.userData.hoverDisabled=!1)}),N.to(f,{opacity:0,duration:.5,onComplete:()=>{f.classList.add("hidden")}})},Q=new Wt(35,P.width/P.height,.1,200),re=new Jn({canvas:to,antialias:!0});re.setSize(P.width,P.height);re.setPixelRatio(Math.min(window.devicePixelRatio,2));const I=new os(Q,re.domElement);I.minDistance=5;I.maxDistance=45;I.minPolarAngle=0;I.maxPolarAngle=Math.PI/2;I.minAzimuthAngle=-1/0;I.maxAzimuthAngle=1/0;I.enableDamping=!0;I.dampingFactor=.05;I.update();window.innerWidth<768?(Q.position.set(-12.909337086928565,8.550931829236296,20.598656336120253),I.target.set(.3329815555892619,2.654559498384689,-.5054645533440316)):(Q.position.set(-5.522436315597833,8.036417974169375,14.73025582438407),I.target.set(-.03621834906034986,2.0794669599639444,-.9874727502508671));window.addEventListener("resize",()=>{P.width=window.innerWidth,P.height=window.innerHeight,Q.aspect=P.width/P.height,Q.updateProjectionMatrix(),re.setSize(P.width,P.height),re.setPixelRatio(Math.min(window.devicePixelRatio,2))});window.addEventListener("mousemove",f=>{dt=!1,he.x=f.clientX/P.width*2-1,he.y=-(f.clientY/P.height)*2+1});window.addEventListener("touchstart",f=>{he.x=f.touches[0].clientX/P.width*2-1,he.y=-(f.touches[0].clientY/P.height)*2+1},{passive:!1});function so(){if(H&&H.length>0){const f=H[0].object;f.userData.clickTimeline&&f.userData.clickTimeline.restart(),f.name.includes("workbtn")?Te(ye.work):f.name.includes("aboutbtn")?Te(ye.about):f.name.includes("contactbtn")?Te(ye.contact):f.name.includes("legalbtn")&&Te(ye.legal)}}window.addEventListener("click",so);let dt=!1;document.querySelectorAll(".modal-exit-button").forEach(f=>{f.addEventListener("touchend",n=>{dt=!0;const e=n.target.closest(".modal");Ut(e)},{passive:!1}),f.addEventListener("click",n=>{if(dt)return;const e=n.target.closest(".modal");Ut(e)},{passive:!1})});const ne=new Vt(Le),rn={terrain:{day:"/textures/terrain_texture.webp"},other:{day:"/textures/other_texture.webp"},pcwei:{day:"/textures/pcwei_texture.webp"}},z=[ne.load("/textures/monitor/monitor_A_texture.webp"),ne.load("/textures/monitor/monitor_B_texture.webp"),ne.load("/textures/monitor/monitor_C_texture.webp"),ne.load("/textures/monitor/monitor_D_texture.webp")];z.forEach(f=>{f.flipY=!1});const an={day:{}};Object.entries(rn).forEach(([f,n])=>{const e=ne.load(n.day);e.flipY=!1,e.colorSpace=V,an.day[f]=e});const ln=new gs;ln.setDecoderPath("/draco/");const cn=new Ts(Le);cn.setDRACOLoader(ln);const oo={default:{scale:[1.3,1.3,1.3],position:[.1,-.1,.1],rotation:[0,-Math.PI/8,0]},v2:{scale:[1.1,1.5,1.1],position:[0,.05,0],rotation:[0,Math.PI/18,0]},v3:{scale:[1.2,1.5,1.2],position:[0,0,0],rotation:[0,0,0]},DJ:{scale:[1.2,1.2,1.2],position:[0,0,0],rotation:[0,Math.PI/3,0]},slider:{scale:[1.1,1.2,1.1],position:[0,0,0],rotation:[0,0,0]},pcbtn:{scale:[1.2,1.1,1.1],position:[0,0,0],rotation:[0,0,0]},Tthings:{scale:[1.2,1,1.2],position:[0,0,0],rotation:[0,0,0]}},io={DJ:{scale:[1,1.5,1],position:[0,-.03,0],duration:.3,easeOut:"elastic.out(1, 0.3)"},pcbtn:{scale:[1,1,1],position:[0,0,-.02],duration:.3,easeOut:"elastic.out(1, 0.3)"}};cn.load("/models/desert.glb",f=>{const n=new Qn().setPath("/textures/skymap/").load(["px.webp","nx.webp","py.webp","ny.webp","pz.webp","nz.webp"]);W.environment=n,f.scene.traverse(e=>{if(!e.isMesh)return;const i=e.name;if(Object.keys(rn).forEach(s=>{if(e.name.includes(s)){const r=new q({map:an.day[s]});r.map.minFilter=Ae,e.material=r}}),e.name.includes("slider")&&(J=e,e.userData.originalPosition=e.position.clone(),ie.push(e)),e.name.includes("cloud")&&(e.material.transparent=!0,e.material.opacity=.7,en.push({mesh:e,baseY:e.position.y,floatSpeed:Math.random()*.1+.05,floatOffset:Math.random()*Math.PI*2,rotationSpeed:Math.random()*2e-4+5e-5})),e.name.includes("roA")?tn.push({mesh:e}):i.includes("raB")&&nn.push({mesh:e}),e.name.includes("raycaster")&&ie.push(e),e.name.includes("pcwei")){const s=e.material.map;e.material=new ht({map:s,metalness:.9,roughness:.2,envMap:n,envMapIntensity:3})}if(e.name.includes("monitor")&&(C=e,e.material=new pt({uniforms:{uTextureA:{value:z[k]},uTextureB:{value:z[ce]},uBrightness:{value:0},uContrast:{value:0},uMix:{value:0},uAberrationAmount:{value:.01}},vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv;
          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        }
      `,fragmentShader:`
uniform sampler2D uTextureA;
uniform sampler2D uTextureB;
uniform float uBrightness;
uniform float uContrast;
uniform float uMix;
uniform float uAberrationAmount; // Add this uniform in JS
varying vec2 vUv;

void main() {
  // Chromatic offset vector (can be radial, here it's a fixed offset)
  vec2 offset = vec2(uAberrationAmount);

  // Sample each channel at slightly different UVs
  vec4 texA = vec4(
    texture2D(uTextureA, vUv + offset).r,   // Red
    texture2D(uTextureA, vUv).g,            // Green
    texture2D(uTextureA, vUv - offset).b,   // Blue
    1.0
  );

  vec4 texB = vec4(
    texture2D(uTextureB, vUv + offset).r,
    texture2D(uTextureB, vUv).g,
    texture2D(uTextureB, vUv - offset).b,
    1.0
  );

  vec4 mixed = mix(texA, texB, uMix);

  // Apply brightness and contrast
  mixed.rgb = (mixed.rgb - 0.5) * uContrast + 0.5;
  mixed.rgb *= uBrightness;

  gl_FragColor = mixed;
}
      `})),e.name.includes("DJ")||e.name.includes("pcbtn")){let s=null;e.name.includes("DJ")?s="DJ":e.name.includes("pcbtn")&&(s="pcbtn");const r=io[s],[a,u,c]=r.scale,[d,_,t]=r.position,o={...e.position},l=N.timeline({paused:!0});l.to(e.scale,{x:e.scale.x*a,y:e.scale.y*u,z:e.scale.z*c,duration:r.duration*.5,ease:"power2.in"}),l.to(e.position,{x:o.x+d,y:o.y+_,z:o.z+t,duration:r.duration*.5,ease:"power2.out"},0),l.to(e.scale,{x:e.scale.x,y:e.scale.y,z:e.scale.z,duration:r.duration,ease:r.easeOut}),l.to(e.position,{x:o.x,y:o.y,z:o.z,duration:r.duration,ease:r.easeOut},`-=${r.duration}`),e.userData.clickTimeline=l,ie.push(e)}if(e.name.includes("workbtn")&&(Ye=e),e.name.includes("contactbtn")&&(qe=e),e.name.includes("aboutbtn")&&(We=e),e.name.includes("legalbtn")&&(Ze=e),e.name.includes("pcbtn")&&(Je=e),e.name.includes("DJ1")&&(Qe=e),e.name.includes("DJ2")&&($e=e),e.name.includes("DJ3")&&(et=e),e.name.includes("DJ4")&&(tt=e),e.name.includes("DJ5")&&(nt=e),e.name.includes("DJ6")&&(st=e),e.name.includes("DJ7")&&(ot=e),e.name.includes("DJ8")&&(it=e),e.name.includes("DJ9")&&(rt=e),e.name.includes("hover")){e.userData.initialScale=e.scale.clone(),e.userData.initialPosition=e.position.clone(),e.userData.initialRotation=e.rotation.clone();let s="default";e.name.includes("v2")?s="v2":e.name.includes("v3")?s="v3":e.name.includes("DJ")?s="DJ":e.name.includes("Tthings")?s="Tthings":e.name.includes("slider")?s="slider":e.name.includes("pcbtn")&&(s="pcbtn");const r=oo[s],[a,u,c]=r.scale,[d,_,t]=r.position,[o,l,h]=r.rotation,m=N.timeline({paused:!0});m.to(e.scale,{x:e.userData.initialScale.x*a,y:e.userData.initialScale.y*u,z:e.userData.initialScale.z*c,duration:.3,ease:"power2.out"},0),m.to(e.position,{x:e.userData.initialPosition.x+d,y:e.userData.initialPosition.y+_,z:e.userData.initialPosition.z+t,duration:.3,ease:"power2.out"},0),m.to(e.rotation,{x:e.userData.initialRotation.x+o,y:e.userData.initialRotation.y+l,z:e.userData.initialRotation.z+h,duration:.3,ease:"power2.out"},0),e.userData.hoverTimeline=m}}),W.add(f.scene)});function ro(){Ye.scale.set(0,0,0),qe.scale.set(0,0,0),We.scale.set(0,0,0),Ze.scale.set(0,0,0),Je.scale.set(0,0,0),J.scale.set(0,0,0),Qe.scale.set(0,0,0),$e.scale.set(0,0,0),et.scale.set(0,0,0),tt.scale.set(0,0,0),nt.scale.set(0,0,0),st.scale.set(0,0,0),ot.scale.set(0,0,0),it.scale.set(0,0,0),rt.scale.set(0,0,0);const f=N.timeline({defaults:{duration:.8,ease:"back.out(1.8)"}});f.timeScale(.5),f.to(Ye.scale,{x:1,y:1,z:1}).to(We.scale,{x:1,y:1,z:1},"-=0.6").to(qe.scale,{x:1,y:1,z:1},"-=0.6").to(Ze.scale,{x:1,y:1,z:1},"-=0.6"),f.then(()=>n.play());const n=N.timeline({paused:!0,defaults:{duration:.8,ease:"back.out(1.8)"}});n.to(Je.scale,{x:1,y:1,z:1}).to(J.scale,{x:1,y:1,z:1},"-=0.6").to(Qe.scale,{x:1,y:1,z:1},"-=0.6").to($e.scale,{x:1,y:1,z:1},"-=0.6").to(et.scale,{x:1,y:1,z:1},"-=0.6").to(tt.scale,{x:1,y:1,z:1},"-=0.6").to(nt.scale,{x:1,y:1,z:1},"-=0.6").to(st.scale,{x:1,y:1,z:1},"-=0.6").to(ot.scale,{x:1,y:1,z:1},"-=0.6").to(it.scale,{x:1,y:1,z:1},"-=0.6").to(rt.scale,{x:1,y:1,z:1},"-=0.6")}const ft=100,Bt=1,ao=new Se(ft,ft,Bt,Bt),lo=new pt({transparent:!0,uniforms:{uSize:{value:ft}},vertexShader:`
        varying vec2 vUv;
        void main() {
          vUv = uv - 0.5;
          gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        }
      `,fragmentShader:`
  varying vec2 vUv;
  uniform float uSize;

  float gridLine(float coord, float size) {
    float line = abs(fract(coord * size) - 0.5);
    return smoothstep(0.1, 0.0, line); // smooth lines
  }

  void main() {
    float dist = length(vUv) * 2.0;
    float alpha = smoothstep(1.0, 0.5, dist);

    float xLine = gridLine(vUv.x, uSize);
    float yLine = gridLine(vUv.y, uSize);
    float lineStrength = max(xLine, yLine);

    gl_FragColor = vec4(vec3(0.2), alpha * lineStrength * 0.1);
  }
`}),yt=new pe(ao,lo);yt.rotation.x=-Math.PI/2;yt.position.set(.5,-2.01,.5);W.add(yt);const Tt=new pe(new Se(100,.1),new q({color:16711680,transparent:!0,opacity:.3,depthWrite:!1}));Tt.rotation.x=-Math.PI/2;Tt.position.set(0,-2,0);W.add(Tt);const Re=new pe(new Se(100,.1),new q({color:65280,transparent:!0,opacity:.3,depthWrite:!1}));Re.rotation.z=Math.PI/2;Re.rotation.x=-Math.PI/2;Re.position.set(0,-2,0);W.add(Re);const De=new Se(2.5,8,16,64);De.translate(-.5,5,-2);De.scale(.5,.5,.5);De.rotateY(-Math.PI/2.2);const bt=ne.load("/shaders/perlin.png");bt.wrapS=fe;bt.wrapT=fe;const co=`
uniform float uTime;
uniform sampler2D uPerlinTexture;

varying vec2 vUv;

vec2 rotate2D(vec2 pos, float angle) {
  float s = sin(angle);
  float c = cos(angle);
  return mat2(c, -s, s, c) * pos;
}

void main() {
  vec3 newPosition = position;

  float twistPerlin = texture(uPerlinTexture, vec2(0.5, uv.y * 0.2 - uTime * 0.01)).r;
  float angle = twistPerlin * 3.0;
  newPosition.xz = rotate2D(newPosition.xz, angle);

  vec2 windOffset = vec2(
    texture(uPerlinTexture, vec2(0.25, uTime * 0.01)).r - 0.5,
    texture(uPerlinTexture, vec2(0.75, uTime * 0.01)).r - 0.5
  );
  windOffset *= pow(uv.y, 2.0) * 1.5;
  newPosition.xz += windOffset;

  gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0);
  vUv = uv;
}
`,uo=`
uniform float uTime;
uniform sampler2D uPerlinTexture;

varying vec2 vUv;

void main() {
  vec2 smokeUv = vUv;
  smokeUv.x *= 0.5;
  smokeUv.y *= 0.3;
  smokeUv.y -= uTime * 0.04;

  float smoke = texture(uPerlinTexture, smokeUv).r;
  smoke = smoothstep(0.5, 1.0, smoke);

  smoke *= smoothstep(0.0, 0.1, vUv.x);
  smoke *= smoothstep(1.0, 0.9, vUv.x);
  smoke *= smoothstep(0.0, 0.1, vUv.y);
  smoke *= smoothstep(1.0, 0.4, vUv.y);

/* gl_FragColor = vec4(1.0, 0.0, 0.0, 1.0); */
gl_FragColor = vec4(1, 1, 1, smoke); 
}
`,un=new pt({vertexShader:co,fragmentShader:uo,uniforms:{uTime:new Lt(0),uPerlinTexture:new Lt(bt)},side:qt,transparent:!0,depthWrite:!1}),dn=new pe(De,un);dn.position.set(0,2,0);W.add(dn);const fo=new $n;W.background=new X("#c5dba7");const fn=()=>{var s;I.update();const f=fo.getElapsedTime(),i=ve.degToRad(180)+Math.sin(f*1.5)*ve.degToRad(10/2);if(un.uniforms.uTime.value=f,en.forEach(r=>{const a=r.mesh;a.position.y=r.baseY+Math.sin(f*r.floatSpeed+r.floatOffset)*.5,a.rotation.y+=r.rotationSpeed}),tn.forEach(r=>{r.mesh.rotation.x=i}),nn.forEach(r=>{r.mesh.rotation.x=-i}),!mt){Ft.setFromCamera(he,Q),H=Ft.intersectObjects(ie);let r=null,a=!1,u=!1,c=!1;if(H.length>0&&(r=H[0].object,a=r.name.includes("monitor"),u=r.name.includes("pointer"),c=r.name.includes("hover")),c&&!r.userData.hoverDisabled?r!==G&&(G&&G.userData.hoverTimeline&&G.userData.hoverTimeline.reverse(),r.userData.hoverTimeline&&r.userData.hoverTimeline.play(),G=r):G&&G.userData.hoverTimeline&&(G.userData.hoverTimeline.reverse(),G=null),a&&k===3?document.body.style.cursor="not-allowed":u||a?document.body.style.cursor="pointer":document.body.style.cursor="default",at&&((s=C==null?void 0:C.material)!=null&&s.uniforms)){const d=C.material.uniforms;me+=(1-me)*.05,ge+=(1-ge)*.05,d.uBrightness.value=me,d.uContrast.value=ge,Math.abs(1-me)<.01&&Math.abs(1-ge)<.01&&(d.uBrightness.value=1,d.uContrast.value=1,at=!1)}}re.render(W,Q),requestAnimationFrame(fn)};fn();window.addEventListener("click",()=>{if(!H||H.length===0)return;const f=H[0].object;if(f.name.includes("monitor")&&k<3&&(F&&k<3&&Ge.play(),ce=k+1,C.material.uniforms)){const e=C.material.uniforms;e.uTextureA.value=z[k],e.uTextureB.value=z[ce],e.uMix.value=0,N.to(e.uMix,{value:1,duration:.5,ease:"power2.inOut",onComplete:()=>{k=ce,e.uTextureA.value=z[k],e.uTextureB.value=z[k],e.uMix.value=0}})}const n=f.name.match(/DJ[1-9]/);if(n){const e=n[0];Object.values(ct).forEach(i=>i.stop()),F&&ct[e].play()}if(f.name.includes("pcbtn")&&F&&Ge.play(),f.name.includes("slider")&&F&&Ht.play(),f.name.includes("pcbtn")&&C&&C.material&&C.material.uniforms){k=0,ce=1;const e=C.material.uniforms;e.uTextureA.value=z[k],e.uTextureB.value=z[k],e.uMix.value=0,F&&Ge.play()}if(f.name.includes("slider")&&J){F&&Ht.play();const e=J.userData.originalPosition;Ue?N.to(J.position,{x:e.x+Be.x,y:e.y+Be.y,z:e.z+Be.z,duration:.8,ease:"power2.inOut"}):N.to(J.position,{x:e.x,y:e.y,z:e.z,duration:.8,ease:"power2.inOut"}),Ue=!Ue}(f.name.includes("slider")||f.name.includes("pcbtn")||f.name.includes("DJ"))&&(f.userData.originalColor||(f.userData.originalColor=f.material.color.clone()),N.to(f.material.color,{r:1,g:3,b:1,duration:.2,yoyo:!0,repeat:1,onComplete:()=>{f.material.color.copy(f.userData.originalColor)}}))});
